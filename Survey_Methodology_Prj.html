<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Survey Methodology Group Prj</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Survey_Methodology_Prj_files/libs/clipboard/clipboard.min.js"></script>
<script src="Survey_Methodology_Prj_files/libs/quarto-html/quarto.js"></script>
<script src="Survey_Methodology_Prj_files/libs/quarto-html/popper.min.js"></script>
<script src="Survey_Methodology_Prj_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Survey_Methodology_Prj_files/libs/quarto-html/anchor.min.js"></script>
<link href="Survey_Methodology_Prj_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Survey_Methodology_Prj_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Survey_Methodology_Prj_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Survey_Methodology_Prj_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Survey_Methodology_Prj_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Survey_Methodology_Prj_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Survey_Methodology_Prj_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Survey_Methodology_Prj_files/libs/jquery-3.5.1/jquery.min.js"></script>
<script src="Survey_Methodology_Prj_files/libs/proj4js-2.3.15/proj4.js"></script>
<link href="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/highcharts.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/highcharts-3d.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/highcharts-more.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/stock.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/map.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/data.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/exporting.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/drilldown.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/item-series.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/annotations.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/export-data.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/funnel.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/heatmap.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/treemap.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/sankey.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/organization.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/streamgraph.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/sunburst.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/vector.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/wordcloud.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/xrange.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/tilemap.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/venn.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/gantt.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/timeline.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/bullet.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/coloraxis.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/dumbbell.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/lollipop.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/series-label.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/plugins/motion.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/custom/reset.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highcharts-9.3.1/modules/boost.js"></script>
<script src="Survey_Methodology_Prj_files/libs/highchart-binding-0.9.4/highchart.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Survey Methodology Group Prj</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="final-assignment" class="level1">
<h1>Final Assignment</h1>
<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(highcharter)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-uploading" class="level2">
<h2 class="anchored" data-anchor-id="data-uploading">Data uploading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data_cleaning_files/ZA7575.dta"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>edueco_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_cleaning_files/UNESCO Edu Country Data 2019/edueco_data.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>trans_health_data <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"data_cleaning_files/trans_health_data.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ilga_data <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="st">"data_cleaning_files/ilga_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p>Cleaning specific variables to determine which are the more important ones for our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_clean<span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.labelled), as.numeric))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data_clean <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))<span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(edition,studyno1, studyno2,survey, caseid, uniqid))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="handling-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="handling-missing-data">Handling missing data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>total_missing <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(data_clean))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total Missing:"</span>, total_missing, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total Missing: 2506136 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>missing_per_column <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(data_clean))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>missing_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(missing_per_column), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Missing_Count =</span> missing_per_column, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Missing_Percentage =</span> (missing_per_column <span class="sc">/</span> <span class="fu">nrow</span>(data)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>missing_df <span class="ot">&lt;-</span> missing_df[<span class="fu">order</span>(<span class="sc">-</span>missing_df<span class="sc">$</span>Missing_Percentage), ]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>high_missing <span class="ot">&lt;-</span> missing_df[missing_df<span class="sc">$</span>Missing_Percentage <span class="sc">&gt;</span> <span class="dv">50</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In general, there are <strong>2,506,136 missing values</strong> in the data set. The output of the code shows the names of the columns (<code>p6mt</code>,&nbsp;<code>p13mt</code>,&nbsp;<code>p6cy</code>, etc.) and the corresponding counts of missing values for each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>high_missing_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(missing_per_column[missing_per_column <span class="sc">&gt;</span><span class="dv">50</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data_clean[, <span class="sc">!</span>(<span class="fu">names</span>(data_clean) <span class="sc">%in%</span> high_missing_vars)]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>constant_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">Filter</span>(<span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)) <span class="sc">==</span> <span class="dv">1</span>, data_clean))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data_clean[, <span class="sc">!</span>(<span class="fu">names</span>(data_clean) <span class="sc">%in%</span> constant_vars)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, we identified and removed columns that had more than 50% missing values, as they can negatively affect the quality of analysis. This was achieved by creating a list of columns where the missing data percentage exceeded 50%, and then filtering out these columns from the&nbsp;<code>data_clean</code>&nbsp;data set.</p>
<p>Then, we removed constant columns, which do not provide useful information for the analysis, since they lack variability. To identify constant columns, we checked each column for the number of unique values and filtered out those that only had one unique value. This step ensures that the data set contains only columns that offer meaningful variation and are more useful for analysis.</p>
</section>
<section id="formatting-and-more" class="level3">
<h3 class="anchored" data-anchor-id="formatting-and-more">Formatting and more…</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> data_clean[, <span class="fu">sapply</span>(data_clean, is.numeric)]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify constant columns (standard deviation = 0)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>zero_sd_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(numeric_data, <span class="cf">function</span>(x) <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove constant columns</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> numeric_data[, <span class="sc">!</span>zero_sd_vars]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_data, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>high_cor <span class="ot">&lt;-</span> <span class="fu">findCorrelation</span>(cor_matrix, <span class="at">cutoff =</span> <span class="fl">0.90</span>) </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> numeric_data[, <span class="sc">-</span>high_cor]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We created a subset containing only the numeric data. This was achieved by selecting the numeric columns from the&nbsp;<code>data_clean</code>&nbsp;dataset using the&nbsp;<code>sapply()</code>&nbsp;function. Then, we created a new data set (<code>numeric_data</code>) that contained only the numeric columns, so that we can focus on the variables that are relevant for numerical analysis and exclude any non-numeric columns that could complicate the process.</p>
<p>We identified constant columns once again: we calculated the standard deviation of each column, and if the standard deviation was 0, it indicated that the column was constant. These columns were flagged and removed from the data set. Removing them ensured that only meaningful columns remained in the data set.</p>
<p>Afterwards, we examined the correlation between the columns in the numeric data set, which measures the relationship between two variables. We used the&nbsp;<code>cor()</code>&nbsp;function to compute the correlation matrix, with the&nbsp;<code>use = "pairwise.complete.obs"</code>&nbsp;argument ensuring that only complete pairs of observations were used, ignoring any missing values. This step was necessary to understand how the variables relate to each other and to avoid issues that arise from highly correlated features, since highly correlated columns can cause multicollinearity in modeling.</p>
<p>Since highly correlated variables can distort the results of regression models and lead to less reliable interpretations, we identified columns with high correlation, meaning a correlation coefficient greater than 0.90. These columns were selected using the&nbsp;<code>findCorrelation()</code>&nbsp;function and removed from the data set.</p>
<p>Since&nbsp;<code>high_cor</code>&nbsp;contained the indices of the highly correlated columns, we excluded those columns from the&nbsp;<code>numeric_data</code>&nbsp;dataset.</p>
<p>The resulting data set, named&nbsp;<code>filtered_data</code>, now contains only the variables that are relevant and not highly correlated. This step was crucial to ensure that we had a data set with distinct and useful features for further analysis.</p>
</section>
<section id="imputation" class="level3">
<h3 class="anchored" data-anchor-id="imputation">Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># List of different imputation methods to test</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>method_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pmm"</span>, <span class="st">"rf"</span>, <span class="st">"cart"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the imputed datasets</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>imputed_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (method <span class="cf">in</span> method_list) {</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Running:"</span>, method, <span class="st">"...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform imputation using the selected method</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  imputed_datasets[[method]] <span class="ot">&lt;-</span> <span class="fu">mice</span>(data_clean, <span class="at">method =</span> method, <span class="at">m =</span> <span class="dv">3</span>, <span class="at">maxit =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Running: pmm ...

 iter imp variable
  1   1
  1   2
  1   3
  2   1
  2   2
  2   3
  3   1
  3   2
  3   3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 14</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Running: rf ...

 iter imp variable
  1   1
  1   2
  1   3
  2   1
  2   2
  2   3
  3   1
  3   2
  3   3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 14</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Running: cart ...

 iter imp variable
  1   1
  1   2
  1   3
  2   1
  2   2
  2   3
  3   1
  3   2
  3   3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 14</code></pre>
</div>
</div>
<p>Thanks to this code, we can test different imputation methods to fill in missing values in the data set&nbsp;<code>data_clean</code> and see which one works best for the data set.</p>
<p>The three imputation methods chosen for testing in this code are&nbsp;<code>"pmm"</code>,&nbsp;<code>"rf"</code>, and&nbsp;<code>"cart"</code>.</p>
<ul>
<li><p><strong>PMM</strong>: Predictive Mean Matching, a method that uses regression models to impute missing values based on similar observed values.</p></li>
<li><p><strong>RF</strong>: Random Forest, a machine learning algorithm that can be used to predict missing values based on the relationships between other variables in the dataset.</p></li>
<li><p><strong>CART</strong>: Classification and Regression Trees, a decision tree method that can be used for both classification and regression tasks, and it is also effective in imputing missing data.</p></li>
</ul>
<p>After we defined the list of imputation methods, the code loops through each of these methods one by one to apply them to our dataset. For each method, a message is printed to let us know which method is currently being used. This makes it easier for us to follow the process, especially when we are running multiple methods.</p>
<p>For each method, the imputation is performed on the <code>data_clean</code> data set: the code creates three different versions of the data set, each with the missing values filled in a slightly different way. These multiple datasets help to ensure that the imputed values are reliable and not just based on one estimation.</p>
<p>To make the imputation process more accurate, the method is run three times for each data set. This means that the imputation is refined over three cycles to get better results. By repeating the process, we can be more confident that the filled-in values are close to what the actual values might have been.</p>
<p>Finally, and after performing the imputation for each method, the resulting datasets are stored in a list, which allows us to keep track of which imputed data set came from which method. Each method’s dataset is labeled by the name of the method, so we can easily compare the results later on to see which method worked best for our data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Original =</span> <span class="fu">as.numeric</span>(numeric_data[[<span class="st">"qc19"</span>]]),  <span class="co"># Original before imputation</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">PMM =</span> <span class="fu">as.numeric</span>(<span class="fu">complete</span>(imputed_datasets[[<span class="st">"pmm"</span>]])[[<span class="st">"qc19"</span>]]),  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RF =</span> <span class="fu">as.numeric</span>(<span class="fu">complete</span>(imputed_datasets[[<span class="st">"rf"</span>]])[[<span class="st">"qc19"</span>]]),  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CART =</span> <span class="fu">as.numeric</span>(<span class="fu">complete</span>(imputed_datasets[[<span class="st">"cart"</span>]])[[<span class="st">"qc19"</span>]])  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_comparison, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">variable.name =</span> <span class="st">"Method"</span>, <span class="at">value.name =</span> <span class="st">"qc19_values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
</div>
<p>The first part of the code creates a new dataset called&nbsp;<code>data_comparison</code>, used to compare the original data (before any imputation) with the imputed values. This dataset includes the&nbsp;<code>qc19</code>&nbsp;column from the original data and the imputed values from the three different methods (PMM, RF, and CART). Each method’s imputed values are extracted from the imputed datasets we generated earlier and added to the comparison table. The purpose of this is to visually compare the original data with the different imputation methods to see how the imputed values differ.</p>
<p>Then, we use the&nbsp;<code>reshape2</code>&nbsp;library to transform the data into a format suitable for plotting. The&nbsp;<code>melt()</code>&nbsp;function is used to convert the data into a “long format,” where each row represents a value from one of the imputed datasets, along with the method used. The new column called “Method” stores the method names (PMM, RF, and CART), and the column&nbsp;<code>qc19_values</code>&nbsp;stores the values for the&nbsp;<code>qc19</code>&nbsp;column from each dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> qc19_values, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Method, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  <span class="co"># Separate plots for each method</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Imputation Methods"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"qc19 Values"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Thanks to this graph, we can compare the distribution of qc19 values across different imputation methods (PMM, RF, CART) and the original dataset.<br>
The distributions in each subplot look quite similar, suggesting that the imputed data preserves the original pattern well.<br>
Some imputation methods may introduce subtle differences, particularly in the frequency of certain qc19 values, which can be seen in slight variations in bar heights.</p>
</section>
</section>
<section id="merging-all-datasets" class="level2">
<h2 class="anchored" data-anchor-id="merging-all-datasets">Merging all datasets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1:  relevant columns from filtered_data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> filtered_data <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"serialid"</span>, <span class="st">"d70"</span>, <span class="st">"d71_1"</span>, <span class="st">"d71_2"</span>, <span class="st">"d71_3"</span>, <span class="st">"d72_1"</span>, <span class="st">"d72_2"</span>, <span class="st">"polintr"</span>, <span class="st">"d10"</span>, <span class="st">"d25"</span>, <span class="st">"d1"</span>, <span class="st">"d63"</span>, <span class="st">"sd2_1"</span>, <span class="st">"sd2_2"</span>, <span class="st">"sd2_3"</span>, <span class="st">"sd2_4"</span>, <span class="st">"sd2_5"</span>, <span class="st">"sd2_6"</span>, <span class="st">"sd2_7"</span>, <span class="st">"sd3"</span>, <span class="st">"qc1_4"</span>, <span class="st">"qc1_8"</span>, <span class="st">"qc1_10"</span>, <span class="st">"d8r1"</span>, <span class="st">"d8r2"</span>, <span class="st">"d8"</span>, <span class="st">"qc19"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: relevant columns from `data`</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"serialid"</span>, <span class="st">"isocntry"</span>, <span class="st">"qc17_4"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_5"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trans_health_data) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(trans_health_data))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ilga_data) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(ilga_data))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>edueco_data <span class="ot">&lt;-</span> edueco_data <span class="sc">|&gt;</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(trans_health_data, <span class="at">by=</span> <span class="st">"country"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>edueco_data <span class="ot">&lt;-</span> edueco_data <span class="sc">|&gt;</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ilga_data, <span class="at">by=</span> <span class="st">"country"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Merge country_data with edueco_data based on country codes</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(edueco_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"isocntry"</span> <span class="ot">=</span> <span class="st">"iso2c"</span>))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Merge selected_data with country_data using "serialid" as the key</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> selected_data <span class="sc">%&gt;%</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(country_data, <span class="at">by =</span> <span class="st">"serialid"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">|&gt;</span> <span class="fu">rename</span>(</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">lifesat =</span> d70,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">natmat =</span> d71_1,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">eumat =</span> d71_2,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">locmat =</span> d71_3,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">euvoice =</span> d72_1,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">natvoice =</span> d72_2,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> d10,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">community =</span> d25,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ideo =</span> d1,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> d63,</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">ethnic =</span> sd2_1,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">skin =</span> sd2_2,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">relig =</span> sd2_3,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">roma =</span> sd2_4,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> sd2_5,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">disab =</span> sd2_6,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">other =</span> sd2_7,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">religion =</span> sd3,</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexdiscr =</span> qc1_4,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">transdiscr =</span> qc1_8,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">interdiscr =</span> qc1_10,</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">transgender_civil_dc =</span> qc19,</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">gdp =</span> <span class="st">`</span><span class="at">NY.GDP.MKTP.CD</span><span class="st">`</span>,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">edu_exp_pct =</span> <span class="st">`</span><span class="at">SE.XPD.TOTL.GD.ZS</span><span class="st">`</span>,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">preprim_exp =</span> <span class="st">`</span><span class="at">PrePrimary (XSPENDP.02.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">prim_exp =</span> <span class="st">`</span><span class="at">Primary (XSPENDP.1.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">lose_exp =</span> <span class="st">`</span><span class="at">LowerSecondary (XSPENDP.2.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">upse_exp =</span> <span class="st">`</span><span class="at">UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">ter_exp =</span> <span class="st">`</span><span class="at">Tertiary (XSPENDP.3.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">voc_exp =</span> <span class="st">`</span><span class="at">VocationalTraining (XSPENDP.4.FDPUB.FNCUR)</span><span class="st">`</span>,</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">school_div_sexual_orientation =</span> qc17_3,</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">school_div_transgender =</span> qc17_4,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">school_div_intersex=</span> qc17_5, </span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_edu =</span> d8,</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_edu_5cat =</span> d8r1,</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_edu_11cat =</span> d8r2,</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">nolger =</span> <span class="st">`</span><span class="at">no legal framework making legal gender recognition impossible</span><span class="st">`</span>,</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="at">exist_lgme =</span> <span class="st">`</span><span class="at">existence of legal measures</span><span class="st">`</span>,</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="at">exist_adm =</span> <span class="st">`</span><span class="at">existence of administrative procedures</span><span class="st">`</span>,</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="at">name_change =</span> <span class="st">`</span><span class="at">name change</span><span class="st">`</span>,</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="at">nar_name_change =</span> <span class="st">`</span><span class="at">no age restriction, name change</span><span class="st">`</span>,</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a><span class="at">self_det =</span> <span class="st">`</span><span class="at">self-determination</span><span class="st">`</span>,</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="at">nb_recog =</span> <span class="st">`</span><span class="at">non-binary recognition</span><span class="st">`</span>,</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a><span class="at">psych_diag =</span> <span class="st">`</span><span class="at">no 'gender identity disorder' diagnosis/psychological opinion required</span><span class="st">`</span>,</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a><span class="at">med_interven =</span> <span class="st">`</span><span class="at">no compulsory medical intervention required</span><span class="st">`</span>,</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a><span class="at">surg_interven =</span> <span class="st">`</span><span class="at">no compulsory surgical intervention required</span><span class="st">`</span>,</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a><span class="at">steril_req =</span> <span class="st">`</span><span class="at">no compulsory sterilisation required</span><span class="st">`</span>,</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a><span class="at">div_req =</span> <span class="st">`</span><span class="at">no compulsory divorce required</span><span class="st">`</span>,</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="at">age_restrict =</span> <span class="st">`</span><span class="at">no age restriction</span><span class="st">`</span>,</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="at">lgrp_minors =</span> <span class="st">`</span><span class="at">legal gender recognition procedures exist for minors</span><span class="st">`</span>,</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="at">depath =</span> <span class="st">`</span><span class="at">depathologisation</span><span class="st">`</span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>merged_data<span class="ot">&lt;-</span> merged_data <span class="sc">|&gt;</span> </span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(x, isocntry, ...<span class="dv">1</span>))</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(country, iso3c, <span class="fu">everything</span>())</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(merged_data, <span class="st">"final_data.csv"</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(merged_data, "final_data.csv", col.names = TRUE): attempt
to set 'col.names' ignored</code></pre>
</div>
</div>
</section>
<section id="descriptive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-analysis">Descriptive Analysis</h2>
<p>In this section, we aim to identify factors influencing support for or opposition to transgender rights, particularly the ability to change civil documents. Our analysis will alternate between individual-level and country-level perspectives</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data_cleaning_files/final_data.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>final_data<span class="ot">&lt;-</span> final_data[, <span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="missing-data-imputation" class="level4">
<h4 class="anchored" data-anchor-id="missing-data-imputation">Missing data imputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#numeric variables</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country             iso3c              serialid        lifesat     
 Length:23798       Length:23798       Min.   :    1   Min.   :1.000  
 Class :character   Class :character   1st Qu.: 5950   1st Qu.:1.000  
 Mode  :character   Mode  :character   Median :11900   Median :2.000  
                                       Mean   :13188   Mean   :1.977  
                                       3rd Qu.:20408   3rd Qu.:2.000  
                                       Max.   :27438   Max.   :5.000  
                                                                      
     natmat          eumat           locmat         euvoice     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
 Median :2.000   Median :2.000   Median :2.000   Median :2.000  
 Mean   :2.019   Mean   :2.195   Mean   :2.036   Mean   :2.649  
 3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:3.000  
 Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :6.000  
                                                                
    natvoice        polintr          gender        community          ideo     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   : 1.0  
 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.: 4.0  
 Median :2.000   Median :2.000   Median :2.000   Median :2.000   Median : 6.0  
 Mean   :2.411   Mean   :2.352   Mean   :1.547   Mean   :1.968   Mean   :21.8  
 3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.: 9.0  
 Max.   :6.000   Max.   :4.000   Max.   :2.000   Max.   :8.000   Max.   :98.0  
                                                                               
     class           ethnic             skin             relig        
 Min.   :1.000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:1.000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :3.000   Median :0.00000   Median :0.00000   Median :0.00000  
 Mean   :2.607   Mean   :0.03067   Mean   :0.01878   Mean   :0.03782  
 3rd Qu.:3.000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :9.000   Max.   :1.00000   Max.   :1.00000   Max.   :1.00000  
                                                                      
      roma             sex              disab             other        
 Min.   :0.0000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :0.0000   Median :0.00000   Median :0.00000   Median :0.00000  
 Mean   :0.0158   Mean   :0.01668   Mean   :0.02542   Mean   :0.01588  
 3rd Qu.:0.0000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :1.0000   Max.   :1.00000   Max.   :1.00000   Max.   :1.00000  
                                                                       
    religion         sexdiscr       transdiscr      interdiscr   
 Min.   : 1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.: 1.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
 Median : 2.000   Median :3.000   Median :3.000   Median :3.000  
 Mean   : 4.758   Mean   :2.799   Mean   :3.141   Mean   :3.399  
 3rd Qu.:12.000   3rd Qu.:3.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :16.000   Max.   :6.000   Max.   :6.000   Max.   :6.000  
                                                                 
  age_edu_5cat    age_edu_11cat      age_edu      transgender_civil_dc
 Min.   : 1.000   Min.   :1.000   Min.   : 0.00   Min.   :1.00        
 1st Qu.: 5.000   1st Qu.:2.000   1st Qu.:18.00   1st Qu.:1.00        
 Median : 6.000   Median :2.000   Median :19.00   Median :1.00        
 Mean   : 7.552   Mean   :2.473   Mean   :26.42   Mean   :1.59        
 3rd Qu.: 9.000   3rd Qu.:3.000   3rd Qu.:23.00   3rd Qu.:2.00        
 Max.   :98.000   Max.   :8.000   Max.   :99.00   Max.   :3.00        
                                                                      
 school_div_transgender school_div_sexual_orientation school_div_intersex
 Min.   :1.000          Min.   :1.000                 Min.   :1.000      
 1st Qu.:1.000          1st Qu.:1.000                 1st Qu.:1.000      
 Median :2.000          Median :2.000                 Median :2.000      
 Mean   :2.351          Mean   :2.236                 Mean   :2.366      
 3rd Qu.:3.000          3rd Qu.:3.000                 3rd Qu.:3.000      
 Max.   :5.000          Max.   :5.000                 Max.   :5.000      
                                                                         
      year           gdp             edu_exp_pct     preprim_exp   
 Min.   :2019   Min.   :1.634e+10   Min.   :3.296   Min.   :86.60  
 1st Qu.:2019   1st Qu.:6.147e+10   1st Qu.:4.095   1st Qu.:91.31  
 Median :2019   Median :2.568e+11   Median :4.630   Median :93.51  
 Mean   :2019   Mean   :4.976e+11   Mean   :4.841   Mean   :93.33  
 3rd Qu.:2019   3rd Qu.:5.367e+11   3rd Qu.:5.260   3rd Qu.:94.92  
 Max.   :2019   Max.   :2.723e+12   Max.   :7.639   Max.   :99.89  
                                                    NA's   :3006   
    prim_exp        lose_exp        upse_exp        ter_exp     
 Min.   :82.98   Min.   :83.10   Min.   :81.38   Min.   :79.99  
 1st Qu.:89.86   1st Qu.:89.86   1st Qu.:90.81   1st Qu.:91.35  
 Median :93.45   Median :93.90   Median :93.69   Median :93.66  
 Mean   :92.50   Mean   :92.68   Mean   :92.96   Mean   :93.37  
 3rd Qu.:95.66   3rd Qu.:95.95   3rd Qu.:95.93   3rd Qu.:96.47  
 Max.   :99.69   Max.   :97.90   Max.   :98.22   Max.   :98.59  
 NA's   :997     NA's   :997     NA's   :997                    
    voc_exp       psychological.care psychiatric.care breast.augmentation
 Min.   :  0.00   Min.   :1.000      Min.   :1.000    Min.   :1.000      
 1st Qu.: 76.64   1st Qu.:1.000      1st Qu.:1.000    1st Qu.:1.000      
 Median : 91.25   Median :1.000      Median :1.000    Median :1.000      
 Mean   : 74.39   Mean   :1.043      Mean   :1.043    Mean   :1.214      
 3rd Qu.: 97.83   3rd Qu.:1.000      3rd Qu.:1.000    3rd Qu.:1.000      
 Max.   :100.00   Max.   :2.000      Max.   :2.000    Max.   :3.000      
 NA's   :6082                                                            
 electrolysis...laser.hair.removal facial.feminisation.surgery hrt..oestrogen.
 Min.   :1.000                     Min.   :1.000               Min.   :1.000  
 1st Qu.:1.000                     1st Qu.:1.000               1st Qu.:1.000  
 Median :1.000                     Median :2.000               Median :1.000  
 Mean   :1.427                     Mean   :1.744               Mean   :1.129  
 3rd Qu.:2.000                     3rd Qu.:2.000               3rd Qu.:1.000  
 Max.   :3.000                     Max.   :3.000               Max.   :2.000  
                                                                              
 hrt..testosterone.  hysterectomy     mastectomy    metoidioplasty 
 Min.   :1.000      Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000      1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000      Median :1.000   Median :1.000   Median :2.000  
 Mean   :1.085      Mean   :1.279   Mean   :1.342   Mean   :1.725  
 3rd Qu.:1.000      3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :2.000      Max.   :3.000   Max.   :3.000   Max.   :3.000  
                                                                   
  orchiectomy   ovariectomy..aka.oopherectomy.  phalloplasty   tracheal.shave 
 Min.   :1.00   Min.   :1.000                  Min.   :1.000   Min.   :1.000  
 1st Qu.:1.00   1st Qu.:1.000                  1st Qu.:1.000   1st Qu.:1.000  
 Median :1.00   Median :1.000                  Median :2.000   Median :1.000  
 Mean   :1.49   Mean   :1.404                  Mean   :1.553   Mean   :1.492  
 3rd Qu.:2.00   3rd Qu.:2.000                  3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :3.00   Max.   :3.000                  Max.   :3.000   Max.   :3.000  
                                                                              
  vaginoplasty   vocal.training      nolger         exist_lgme    
 Min.   :1.000   Min.   :1.000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.0000   1st Qu.:1.0000  
 Median :1.000   Median :1.000   Median :1.0000   Median :1.0000  
 Mean   :1.511   Mean   :1.342   Mean   :0.9135   Mean   :0.7647  
 3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :3.000   Max.   :3.000   Max.   :1.0000   Max.   :1.0000  
                                                                  
   exist_adm       name_change     nar_name_change     self_det     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :1.0000   Median :1.0000   Median :1.0000   Median :0.0000  
 Mean   :0.8274   Mean   :0.7857   Mean   :0.5084   Mean   :0.2968  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
                                                                    
    nb_recog   psych_diag      med_interven    surg_interven   
 Min.   :0   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.0000  
 Median :0   Median :0.0000   Median :0.0000   Median :1.0000  
 Mean   :0   Mean   :0.3818   Mean   :0.4676   Mean   :0.7639  
 3rd Qu.:0   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :0   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
                                                               
   steril_req        div_req        age_restrict    lgrp_minors    
 Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :1.0000   Median :1.0000   Median :0.000   Median :1.0000  
 Mean   :0.7639   Mean   :0.5945   Mean   :0.213   Mean   :0.5101  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.000   Max.   :1.0000  
                                                                   
     depath      
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.0208  
 3rd Qu.:0.0000  
 Max.   :1.0000  
                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(final_data) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Data Patterns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this analysis, we examined the missing data patterns in the dataset to assess data completeness and identify potential issues. The visualization helped determine which variables contain missing values and to what extent. While some variables were fully observed, others had significant gaps, requiring appropriate handling strategies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure final_data is a data frame</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(final_data)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># only variables with missing data for imputation</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>impute_vars <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">preprim_exp</span><span class="st">`</span>, <span class="st">`</span><span class="at">prim_exp</span><span class="st">`</span>, <span class="st">`</span><span class="at">lose_exp</span><span class="st">`</span>, <span class="st">`</span><span class="at">upse_exp</span><span class="st">`</span>, <span class="st">`</span><span class="at">voc_exp</span><span class="st">`</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a predictor matrix</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>predictorMatrix <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(impute_vars)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>imputed_data <span class="ot">&lt;-</span> <span class="fu">mice</span>(impute_vars, <span class="at">method =</span> <span class="st">"mean"</span>, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">10</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  1   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  1   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  1   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  1   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  2   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  2   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  2   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  2   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  2   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  3   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  3   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  3   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  3   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  3   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  4   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  4   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  4   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  4   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  4   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  5   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  5   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  5   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  5   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  5   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  6   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  6   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  6   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  6   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  6   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  7   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  7   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  7   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  7   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  7   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  8   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  8   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  8   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  8   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  8   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  9   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  9   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  9   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  9   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  9   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  10   1  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  10   2  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  10   3  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  10   4  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp
  10   5  preprim_exp  prim_exp  lose_exp  upse_exp  voc_exp</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the first imputed dataset</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">preprim_exp =</span> <span class="fu">complete</span>(imputed_data, <span class="dv">1</span>)<span class="sc">$</span>preprim_exp,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">prim_exp =</span> <span class="fu">complete</span>(imputed_data, <span class="dv">1</span>)<span class="sc">$</span>prim_exp,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lose_exp =</span> <span class="fu">complete</span>(imputed_data, <span class="dv">1</span>)<span class="sc">$</span>lose_exp,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">upse_exp =</span> <span class="fu">complete</span>(imputed_data, <span class="dv">1</span>)<span class="sc">$</span>upse_exp,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">voc_exp =</span> <span class="fu">complete</span>(imputed_data, <span class="dv">1</span>)<span class="sc">$</span>voc_exp</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if imputation worked correctly</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>voc_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   74.39   88.32   74.39   95.03  100.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>preprim_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  86.60   92.06   93.33   93.33   94.88   99.89 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>prim_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  82.98   89.86   93.45   92.50   95.66   99.69 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>lose_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  83.10   89.86   93.44   92.68   95.95   97.90 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data<span class="sc">$</span>upse_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  81.38   90.81   93.48   92.96   95.93   98.22 </code></pre>
</div>
</div>
<p>We handled missing data using mean imputation with the MICE package. This method replaces missing values with the average of observed values for each variable, preventing data loss while maintaining consistency. We focused on five education expenditure variables (preprim_exp, prim_exp, lose_exp, upse_exp, voc_exp), ensuring they no longer contain missing values.</p>
<p>After imputation, the summary statistics confirmed that all variables now have complete data, with reasonable mean and range values. However, since mean imputation can reduce variability, we need to check whether the data distribution has been affected. Notably, voc_exp has a minimum value of 0, unlike other variables with higher minimums, suggesting a different distribution pattern.</p>
<p>Overall, our imputation process successfully addressed missing data, making the dataset more reliable for further analysis. To ensure the imputed values align well with the data structure, we recommend additional visual checks, such as histograms or density plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(final_data) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"After Imputation, Missing Data Patterns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The visualization confirms that after performing mean imputation, all missing values in the dataset have been successfully handled. The vertical bar at zero missing values indicates that no variables contain missing data anymore. This means our imputation process effectively filled in all gaps, making the dataset complete and ready for further analysis.</p>
</section>
<section id="descriptive-statistic" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistic"><strong>Descriptive Statistic</strong></h3>
</section>
<section id="individual-level-data" class="level3">
<h3 class="anchored" data-anchor-id="individual-level-data"><strong>(1) Individual-Level Data</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  only individual-level variables</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>individual_vars <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gender, age_edu_5cat, age_edu_11cat, polintr, natvoice, euvoice, relig, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>         roma, skin, sexdiscr, transdiscr, school_div_transgender, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>         school_div_sexual_orientation, school_div_intersex, transgender_civil_dc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We categorized survey variables into meaningful groups (e.g., Demographics, Identity, School Measures). Then, we reshaped the data into a long format and assigned clear labels for better interpretation. We created histograms to visualize the distribution of numerical variables and a bar chart to analyze categorical variables (e.g., gender). The workflow enhances data organization, clarity, and visualization for better insights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to Categorize Variables</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>categorize_variables <span class="ot">&lt;-</span> <span class="cf">function</span>(var_name) {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"age_edu_5cat"</span>, <span class="st">"age_edu_11cat"</span>, <span class="st">"skin"</span>)) {</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Demographics"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"school_div_intersex"</span>, <span class="st">"school_div_sexual_orientation"</span>, <span class="st">"school_div_transgender"</span>)) {</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"School Should Give Information Measures"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"natvoice"</span>, <span class="st">"euvoice"</span>)) {</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Voice Representation"</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"relig"</span>, <span class="st">"roma"</span>)) {</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Identity"</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Other Variables"</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Data</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>improved_data <span class="ot">&lt;-</span> individual_vars <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable_Group =</span> <span class="fu">sapply</span>(Variable, categorize_variables),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable_Label =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"age_edu_5cat"</span> <span class="sc">~</span> <span class="st">"Age-Education (5 cat)"</span>,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"age_edu_11cat"</span> <span class="sc">~</span> <span class="st">"Age-Education (11 cat)"</span>,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"skin"</span> <span class="sc">~</span> <span class="st">"Skin Color"</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"school_div_intersex"</span> <span class="sc">~</span> <span class="st">"School Diversity (Intersex)"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"school_div_sexual_orientation"</span> <span class="sc">~</span> <span class="st">"School Diversity (Sexual Orientation)"</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"school_div_transgender"</span> <span class="sc">~</span> <span class="st">"School Diversity (Transgender)"</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"natvoice"</span> <span class="sc">~</span> <span class="st">"Native Voice"</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"euvoice"</span> <span class="sc">~</span> <span class="st">"European Voice"</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"polintr"</span> <span class="sc">~</span> <span class="st">"Political Interest"</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"relig"</span> <span class="sc">~</span> <span class="st">"Religion"</span>,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"roma"</span> <span class="sc">~</span> <span class="st">"Roma Identity"</span>,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"sexdiscr"</span> <span class="sc">~</span> <span class="st">"Sexual Discrimination"</span>,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">==</span> <span class="st">"transdiscr"</span> <span class="sc">~</span> <span class="st">"Transgender Discrimination"</span>,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Variable</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to Create Histograms</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>create_improved_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_name) {</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Variable_Group <span class="sc">==</span> group_name)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">replace_na</span>(Variable_Label, <span class="st">"Unknown"</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribution of"</span>, group_name),</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Values shown as frequencies rather than percentages for better readability"</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightgray"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Histograms</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>demographics_plot <span class="ot">&lt;-</span> <span class="fu">create_improved_histogram</span>(improved_data, <span class="st">"Demographics"</span>)</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>information_plot <span class="ot">&lt;-</span> <span class="fu">create_improved_histogram</span>(improved_data, <span class="st">"School Should Give Information Measures"</span>)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>voice_plot <span class="ot">&lt;-</span> <span class="fu">create_improved_histogram</span>(improved_data, <span class="st">"Voice Representation"</span>)</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>identity_plot <span class="ot">&lt;-</span> <span class="fu">create_improved_histogram</span>(improved_data, <span class="st">"Identity"</span>)</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>other_plot <span class="ot">&lt;-</span> <span class="fu">create_improved_histogram</span>(improved_data, <span class="st">"Other Variables"</span>)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to Create Bar Charts</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>create_bar_chart <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable_name) {</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>variable_name <span class="sc">%in%</span> <span class="fu">colnames</span>(data)) {</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error: Column"</span>, variable_name, <span class="st">"not found in data!"</span>))</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>  var_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(variable_name)) <span class="sc">%&gt;%</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Value =</span> <span class="fu">all_of</span>(variable_name)) <span class="sc">%&gt;%</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span>  <span class="co"># Remove missing values</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Value) <span class="sc">%&gt;%</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Value =</span> <span class="fu">factor</span>(Value)</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>  var_label <span class="ot">&lt;-</span> improved_data <span class="sc">%&gt;%</span></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> variable_name) <span class="sc">%&gt;%</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Variable_Label) <span class="sc">%&gt;%</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(var_label) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    var_label <span class="ot">&lt;-</span> variable_name</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(var_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Percentage)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribution of"</span>, var_label), <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Bar Chart for Gender</span></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"gender"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(individual_vars)) {</span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>  gender_bar <span class="ot">&lt;-</span> <span class="fu">create_bar_chart</span>(individual_vars, <span class="st">"gender"</span>)</span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Warning: The column 'gender' is missing from the dataset!"</span>)</span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="demographics-age-education-distribution-analysis" class="level4">
<h4 class="anchored" data-anchor-id="demographics-age-education-distribution-analysis">Demographics: Age-Education Distribution Analysis</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>demographics_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This variable categorizes individuals based on the age at which they completed full-time education. The dataset contains two versions: an <strong>11-category classification</strong> and a <strong>simplified 5-category grouping</strong>.</p>
<p>In the <strong>detailed 11-category version</strong>, respondents are categorized from <strong>“Up to 14 years” (1) to “22 years and older” (9)</strong>, alongside <strong>“Still studying” (10)</strong> and <strong>“No full-time education” (11)</strong>. The most common completion ages are <strong>15 years (2) and 16 years (3)</strong>, suggesting that a significant proportion of individuals exit full-time education during their teenage years. In contrast, fewer respondents remain in school past the age of 21.</p>
<p>The <strong>simplified 5-category classification</strong> merges some of these distinctions, grouping individuals as:<br>
- <strong>“Up to 15 years” (1):</strong> Those who left school by age 15.<br>
- <strong>“16-19 years” (2):</strong> Individuals who completed education in their late teens.<br>
- <strong>“20 years and older” (3):</strong> Those pursuing education beyond 19.<br>
- <strong>“Still studying” (4):</strong> Respondents currently in full-time education.<br>
- <strong>“No full-time education” (5):</strong> Individuals who never attended full-time education.</p>
<p>Across both classifications, the data highlights that <strong>most individuals leave full-time education at 15 or 16 years old</strong>, with fewer continuing beyond that. The presence of a <strong>“Still studying”</strong> category indicates an active student population, but the relatively low frequencies in higher education categories suggest that <strong>early school leaving is prevalent</strong>.</p>
<p>These findings offer insights into <strong>educational attainment trends</strong> and could be useful for <strong>policymakers looking to improve retention in higher education</strong>.</p>
<p>Additionally, The skin color variable helps categorize individuals based on whether they identify as a minority in terms of skin color. This distinction is crucial in understanding social dynamics, as it can provide insights into experiences of discrimination, representation, and equality within different groups.</p>
<p>The dataset includes two main categories. The first category (<strong>0 - Not mentioned</strong>) represents individuals who do not identify as part of a racial or ethnic minority based on their skin color. The second category (<strong>1 - A minority in terms of skin color</strong>) includes individuals who perceive themselves as belonging to a racial or ethnic minority group due to their skin tone.</p>
<p>The distribution of responses shows that the vast majority of individuals fall into the “Not mentioned” category, meaning they do not consider themselves as part of a skin color minority. In contrast, a much smaller proportion of respondents identify as belonging to a racial minority.</p>
<p>This finding suggests that racial or ethnic minorities based on skin color constitute a relatively small fraction of the dataset. Understanding this demographic breakdown is essential when examining disparities in economic opportunities, access to education, or social integration. Additionally, this variable can be used to investigate potential discrimination or differences in social perception based on racial identity.</p>
</section>
<section id="school-diversity-attitudes" class="level4">
<h4 class="anchored" data-anchor-id="school-diversity-attitudes">School Diversity Attitudes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a> information_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph illustrates respondents’ opinions on whether schools should provide education about diversity concerning intersex individuals, sexual orientation, and transgender identity. The response categories range from “Totally agree” (1) to “Totally disagree” (4), with an additional category for “Don’t know” (5).</p>
<p>The results indicate that the majority of respondents either “Totally agree” (1) or “Tend to agree” (2) that schools should inform students about diversity in these areas. The highest agreement is observed across all three categories, suggesting broad support for diversity education. However, a notable proportion of respondents “Tend to disagree” (3) or “Totally disagree” (4), reflecting some resistance to integrating these topics into school curricula. Overall, the findings suggest that while most people recognize the importance of diversity education, there are still opposing views that indicate societal divisions on this issue.</p>
</section>
<section id="voice-representation" class="level4">
<h4 class="anchored" data-anchor-id="voice-representation">Voice Representation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>voice_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph represents perceptions of voice representation in two contexts: at the European level (“European Voice”) and at the national level (“Native Voice”). The responses are categorized into levels of agreement, ranging from “Totally agree” (1) to “Totally disagree” (4), with additional categories for refusals and unknown responses.</p>
<p>The data suggests that a significant portion of respondents “Tend to agree” (2) that their voice is heard both in their country and in the EU, making it the most common response. However, there are also notable groups that “Tend to disagree” (3) or “Totally disagree” (4), indicating skepticism about their influence in political or social discussions. The distribution is relatively similar for both European and national contexts, suggesting that perceptions of representation do not differ drastically between these two levels.</p>
</section>
<section id="identity" class="level4">
<h4 class="anchored" data-anchor-id="identity">Identity</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>identity_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The dataset analysis highlights how many people identify as religious or ethnic minorities. The graphs show that most individuals do not consider themselves part of these groups. In particular, only a small number identify as part of a religious minority, and the same goes for those who declare a Roma identity.</p>
</section>
<section id="gender" class="level4">
<h4 class="anchored" data-anchor-id="gender">Gender</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>gender_bar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>According to the results, 54.7% of the respondents are female, while 45.3% are male. This indicates a slight overrepresentation of females in the survey compared to males. The relatively balanced distribution suggests that responses are not significantly skewed toward one gender, allowing for a more comprehensive analysis of gender-based trends and perspectives.</p>
</section>
<section id="other-variables" class="level4">
<h4 class="anchored" data-anchor-id="other-variables">Other variables</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>other_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="discrimination-based-on-sexual-orientation-and-gender-identity" class="level5">
<h5 class="anchored" data-anchor-id="discrimination-based-on-sexual-orientation-and-gender-identity">Discrimination Based on Sexual Orientation and Gender Identity</h5>
<p>Discrimination against individuals based on their <strong>sexual orientation and gender identity</strong> remains a significant issue across various societies. The survey categorizes public perceptions of discrimination into six levels: <strong>Very widespread, Fairly widespread, Fairly rare, Very rare, Non-existent (Spontaneous), and Don’t know (DK)</strong>. These categories help assess the extent to which individuals recognize discrimination in their respective countries.</p>
<p>The results indicate that <strong>the majority of respondents perceive discrimination as either very or fairly widespread</strong>. This suggests that LGBTQ+ individuals, particularly transgender people, continue to face systemic barriers in social, legal, and professional spheres. A smaller proportion of respondents consider discrimination <strong>fairly rare or very rare</strong>, implying regional differences in attitudes and legal frameworks that either mitigate or reinforce these experiences.</p>
<p>Interestingly, <strong>very few respondents believe that discrimination does not exist at all</strong>, reinforcing the notion that discrimination is a recognized issue, even in more progressive societies. Additionally, the presence of responses in the <strong>“Don’t know” category</strong> indicates a lack of awareness or reluctance to express opinions on this subject, which may be influenced by cultural sensitivities or personal biases.</p>
<p>Comparing discrimination against transgender individuals and sexual orientation-based discrimination, <strong>the perception of discrimination against transgender individuals appears slightly higher</strong>. This may stem from the additional social and legal barriers that transgender individuals face, including restrictions on gender recognition, healthcare access, and workplace inclusion.</p>
<p>These findings emphasize the need for <strong>stronger anti-discrimination policies, legal protections, and social awareness initiatives</strong> to ensure the fair treatment of LGBTQ+ individuals. Addressing these issues through education and policy reforms is crucial for fostering inclusive societies that respect and uphold the rights of all individuals, regardless of their gender identity or sexual orientation.</p>
</section>
<section id="political-interest" class="level5">
<h5 class="anchored" data-anchor-id="political-interest">Political Interest</h5>
<p>The Political Interest Index categorizes respondents into four levels: Strong (1), Medium (2), Low (3), and Not at all (4). The distribution shows that the majority of respondents fall into the Medium category, suggesting that most individuals engage with politics to some degree but do not exhibit strong interest. Meanwhile, fewer respondents report either strong political interest or no interest at all. This suggests a general trend toward moderate political engagement among participants.</p>
</section>
<section id="religion" class="level5">
<h5 class="anchored" data-anchor-id="religion">Religion</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>religion_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Catholic"</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Orthodox Christian"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Protestant"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Other Christian"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Jewish"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"Muslim - Shia"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"Muslim - Sunni"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"Other Muslim"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"9"</span> <span class="ot">=</span> <span class="st">"Sikh"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10"</span> <span class="ot">=</span> <span class="st">"Buddhist"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"11"</span> <span class="ot">=</span> <span class="st">"Hindu"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"12"</span> <span class="ot">=</span> <span class="st">"Atheist"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"13"</span> <span class="ot">=</span> <span class="st">"Non believer / Agnostic"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"14"</span> <span class="ot">=</span> <span class="st">"Other"</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"15"</span> <span class="ot">=</span> <span class="st">"Refusal"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"16"</span> <span class="ot">=</span> <span class="st">"Don't Know"</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(religion <span class="sc">%in%</span> <span class="fu">names</span>(religion_labels))</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert religion variable to factor with specific labels</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>religion1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_data<span class="sc">$</span>religion, </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">names</span>(religion_labels), </span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels =</span> religion_labels)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Count occurrences</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>religion_counts <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(religion1) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Count)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>religion_counts <span class="ot">&lt;-</span> religion_counts <span class="sc">%&gt;%</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> (Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(religion_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(religion1, Count), <span class="at">y =</span> Percentage, <span class="at">fill =</span> religion1)) <span class="sc">+</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Religions"</span>,</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Religion"</span>,</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage (%)"</span>,</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Religion"</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution of religious denominations shows that Catholicism is the most dominant religion, followed by Orthodox Christianity and Protestantism, while Non-believers/Agnostics and Atheists also represent a significant portion, indicating a strong secular trend. Muslim groups, including Sunni, Shia, and Other Muslim, are relatively small, suggesting they are a minority in the surveyed population. Other religions, such as Buddhism, Judaism, Hinduism, and Sikhism, have minimal representation. Additionally, a small percentage of respondents either refused to disclose their religious affiliation or selected “Don’t Know,” highlighting potential reluctance or uncertainty regarding religious identity. The data overall reflects a predominantly Christian population with notable secular tendencies and limited religious diversity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>iso3c1 <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(final_data<span class="sc">$</span>iso3c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>western_europe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BEL"</span>, <span class="st">"DNK"</span>, <span class="st">"GRC"</span>, <span class="st">"ESP"</span>, <span class="st">"FIN"</span>, <span class="st">"FRA"</span>, <span class="st">"IRL"</span>, <span class="st">"ITA"</span>, <span class="st">"LUX"</span>, <span class="st">"NLD"</span>, <span class="st">"AUT"</span>, <span class="st">"PRT"</span>, <span class="st">"SWE"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>eastern_europe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BGR"</span>, <span class="st">"CYP"</span>, <span class="st">"CZE"</span>, <span class="st">"EST"</span>, <span class="st">"HUN"</span>, <span class="st">"LVA"</span>, <span class="st">"LTU"</span>, <span class="st">"MLT"</span>, <span class="st">"POL"</span>, <span class="st">"ROU"</span>, <span class="st">"SVN"</span>, <span class="st">"HRV"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>west_data <span class="ot">&lt;-</span> final_data[final_data<span class="sc">$</span>iso3c <span class="sc">%in%</span> western_europe, ]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>east_data <span class="ot">&lt;-</span> final_data[final_data<span class="sc">$</span>iso3c <span class="sc">%in%</span> eastern_europe, ]</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>mean_west <span class="ot">&lt;-</span> <span class="fu">mean</span>(west_data<span class="sc">$</span>transgender_civil_dc)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>mean_east <span class="ot">&lt;-</span> <span class="fu">mean</span>(east_data<span class="sc">$</span>transgender_civil_dc)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average Support in Western Europe: "</span>, mean_west, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Support in Western Europe:  1.418983 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average Support in Eastern Europe: "</span>, mean_east, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Support in Eastern Europe:  1.784983 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(final_data<span class="sc">$</span>iso3c <span class="sc">%in%</span> western_europe, <span class="st">"Western Europe"</span>, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(final_data<span class="sc">$</span>iso3c <span class="sc">%in%</span> eastern_europe, <span class="st">"Eastern Europe"</span>, <span class="cn">NA</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the support percentage by region (Western vs. Eastern Europe)</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>region_support <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">support_percentage =</span> <span class="fu">mean</span>(transgender_civil_dc <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the support percentage by region</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(region_support)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  region         support_percentage
  &lt;chr&gt;                       &lt;dbl&gt;
1 Eastern Europe               36.5
2 Western Europe               66.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for support percentage by region</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_support, <span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">y =</span> support_percentage, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Support for Transgender Rights by Region"</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Region"</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Support Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3C8BFA"</span>, <span class="st">"#663CFA"</span>)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country             iso3c              serialid        lifesat     
 Length:23798       Length:23798       Min.   :    1   Min.   :1.000  
 Class :character   Class :character   1st Qu.: 5950   1st Qu.:1.000  
 Mode  :character   Mode  :character   Median :11900   Median :2.000  
                                       Mean   :13188   Mean   :1.977  
                                       3rd Qu.:20408   3rd Qu.:2.000  
                                       Max.   :27438   Max.   :5.000  
                                                                      
     natmat          eumat           locmat         euvoice     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
 Median :2.000   Median :2.000   Median :2.000   Median :2.000  
 Mean   :2.019   Mean   :2.195   Mean   :2.036   Mean   :2.649  
 3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:3.000  
 Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :6.000  
                                                                
    natvoice        polintr          gender        community          ideo     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   : 1.0  
 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.: 4.0  
 Median :2.000   Median :2.000   Median :2.000   Median :2.000   Median : 6.0  
 Mean   :2.411   Mean   :2.352   Mean   :1.547   Mean   :1.968   Mean   :21.8  
 3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.: 9.0  
 Max.   :6.000   Max.   :4.000   Max.   :2.000   Max.   :8.000   Max.   :98.0  
                                                                               
     class           ethnic             skin             relig        
 Min.   :1.000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:1.000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :3.000   Median :0.00000   Median :0.00000   Median :0.00000  
 Mean   :2.607   Mean   :0.03067   Mean   :0.01878   Mean   :0.03782  
 3rd Qu.:3.000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :9.000   Max.   :1.00000   Max.   :1.00000   Max.   :1.00000  
                                                                      
      roma             sex              disab             other        
 Min.   :0.0000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :0.0000   Median :0.00000   Median :0.00000   Median :0.00000  
 Mean   :0.0158   Mean   :0.01668   Mean   :0.02542   Mean   :0.01588  
 3rd Qu.:0.0000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :1.0000   Max.   :1.00000   Max.   :1.00000   Max.   :1.00000  
                                                                       
    religion         sexdiscr       transdiscr      interdiscr   
 Min.   : 1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.: 1.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
 Median : 2.000   Median :3.000   Median :3.000   Median :3.000  
 Mean   : 4.758   Mean   :2.799   Mean   :3.141   Mean   :3.399  
 3rd Qu.:12.000   3rd Qu.:3.000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :16.000   Max.   :6.000   Max.   :6.000   Max.   :6.000  
                                                                 
  age_edu_5cat    age_edu_11cat      age_edu      transgender_civil_dc
 Min.   : 1.000   Min.   :1.000   Min.   : 0.00   Min.   :1.00        
 1st Qu.: 5.000   1st Qu.:2.000   1st Qu.:18.00   1st Qu.:1.00        
 Median : 6.000   Median :2.000   Median :19.00   Median :1.00        
 Mean   : 7.552   Mean   :2.473   Mean   :26.42   Mean   :1.59        
 3rd Qu.: 9.000   3rd Qu.:3.000   3rd Qu.:23.00   3rd Qu.:2.00        
 Max.   :98.000   Max.   :8.000   Max.   :99.00   Max.   :3.00        
                                                                      
 school_div_transgender school_div_sexual_orientation school_div_intersex
 Min.   :1.000          Min.   :1.000                 Min.   :1.000      
 1st Qu.:1.000          1st Qu.:1.000                 1st Qu.:1.000      
 Median :2.000          Median :2.000                 Median :2.000      
 Mean   :2.351          Mean   :2.236                 Mean   :2.366      
 3rd Qu.:3.000          3rd Qu.:3.000                 3rd Qu.:3.000      
 Max.   :5.000          Max.   :5.000                 Max.   :5.000      
                                                                         
      year           gdp             edu_exp_pct     preprim_exp   
 Min.   :2019   Min.   :1.634e+10   Min.   :3.296   Min.   :86.60  
 1st Qu.:2019   1st Qu.:6.147e+10   1st Qu.:4.095   1st Qu.:92.06  
 Median :2019   Median :2.568e+11   Median :4.630   Median :93.33  
 Mean   :2019   Mean   :4.976e+11   Mean   :4.841   Mean   :93.33  
 3rd Qu.:2019   3rd Qu.:5.367e+11   3rd Qu.:5.260   3rd Qu.:94.88  
 Max.   :2019   Max.   :2.723e+12   Max.   :7.639   Max.   :99.89  
                                                                   
    prim_exp        lose_exp        upse_exp        ter_exp     
 Min.   :82.98   Min.   :83.10   Min.   :81.38   Min.   :79.99  
 1st Qu.:89.86   1st Qu.:89.86   1st Qu.:90.81   1st Qu.:91.35  
 Median :93.45   Median :93.44   Median :93.48   Median :93.66  
 Mean   :92.50   Mean   :92.68   Mean   :92.96   Mean   :93.37  
 3rd Qu.:95.66   3rd Qu.:95.95   3rd Qu.:95.93   3rd Qu.:96.47  
 Max.   :99.69   Max.   :97.90   Max.   :98.22   Max.   :98.59  
                                                                
    voc_exp       psychological.care psychiatric.care breast.augmentation
 Min.   :  0.00   Min.   :1.000      Min.   :1.000    Min.   :1.000      
 1st Qu.: 74.39   1st Qu.:1.000      1st Qu.:1.000    1st Qu.:1.000      
 Median : 88.32   Median :1.000      Median :1.000    Median :1.000      
 Mean   : 74.39   Mean   :1.043      Mean   :1.043    Mean   :1.214      
 3rd Qu.: 95.03   3rd Qu.:1.000      3rd Qu.:1.000    3rd Qu.:1.000      
 Max.   :100.00   Max.   :2.000      Max.   :2.000    Max.   :3.000      
                                                                         
 electrolysis...laser.hair.removal facial.feminisation.surgery hrt..oestrogen.
 Min.   :1.000                     Min.   :1.000               Min.   :1.000  
 1st Qu.:1.000                     1st Qu.:1.000               1st Qu.:1.000  
 Median :1.000                     Median :2.000               Median :1.000  
 Mean   :1.427                     Mean   :1.744               Mean   :1.129  
 3rd Qu.:2.000                     3rd Qu.:2.000               3rd Qu.:1.000  
 Max.   :3.000                     Max.   :3.000               Max.   :2.000  
                                                                              
 hrt..testosterone.  hysterectomy     mastectomy    metoidioplasty 
 Min.   :1.000      Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000      1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000      Median :1.000   Median :1.000   Median :2.000  
 Mean   :1.085      Mean   :1.279   Mean   :1.342   Mean   :1.725  
 3rd Qu.:1.000      3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :2.000      Max.   :3.000   Max.   :3.000   Max.   :3.000  
                                                                   
  orchiectomy   ovariectomy..aka.oopherectomy.  phalloplasty   tracheal.shave 
 Min.   :1.00   Min.   :1.000                  Min.   :1.000   Min.   :1.000  
 1st Qu.:1.00   1st Qu.:1.000                  1st Qu.:1.000   1st Qu.:1.000  
 Median :1.00   Median :1.000                  Median :2.000   Median :1.000  
 Mean   :1.49   Mean   :1.404                  Mean   :1.553   Mean   :1.492  
 3rd Qu.:2.00   3rd Qu.:2.000                  3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :3.00   Max.   :3.000                  Max.   :3.000   Max.   :3.000  
                                                                              
  vaginoplasty   vocal.training      nolger         exist_lgme    
 Min.   :1.000   Min.   :1.000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.0000   1st Qu.:1.0000  
 Median :1.000   Median :1.000   Median :1.0000   Median :1.0000  
 Mean   :1.511   Mean   :1.342   Mean   :0.9135   Mean   :0.7647  
 3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :3.000   Max.   :3.000   Max.   :1.0000   Max.   :1.0000  
                                                                  
   exist_adm       name_change     nar_name_change     self_det     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :1.0000   Median :1.0000   Median :1.0000   Median :0.0000  
 Mean   :0.8274   Mean   :0.7857   Mean   :0.5084   Mean   :0.2968  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
                                                                    
    nb_recog   psych_diag      med_interven    surg_interven   
 Min.   :0   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.0000  
 Median :0   Median :0.0000   Median :0.0000   Median :1.0000  
 Mean   :0   Mean   :0.3818   Mean   :0.4676   Mean   :0.7639  
 3rd Qu.:0   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :0   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
                                                               
   steril_req        div_req        age_restrict    lgrp_minors    
 Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :1.0000   Median :1.0000   Median :0.000   Median :1.0000  
 Mean   :0.7639   Mean   :0.5945   Mean   :0.213   Mean   :0.5101  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.000   Max.   :1.0000  
                                                                   
     depath                         religion1        iso3c1     
 Min.   :0.0000   Catholic               :9903   Min.   : NA    
 1st Qu.:0.0000   Orthodox Christian     :3904   1st Qu.: NA    
 Median :0.0000   Non believer / Agnostic:3029   Median : NA    
 Mean   :0.0208   Protestant             :2393   Mean   :NaN    
 3rd Qu.:0.0000   Atheist                :1788   3rd Qu.: NA    
 Max.   :1.0000   Other                  :1033   Max.   : NA    
                  (Other)                :1748   NA's   :23798  
    region         
 Length:23798      
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(final_data<span class="sc">$</span>transgender_civil_dc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     3 
12512  8526  2760 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(final_data<span class="sc">$</span>transgender_civil_dc)) <span class="sc">*</span> <span class="dv">100</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       1        2        3 
52.57585 35.82654 11.59761 </code></pre>
</div>
</div>
</section>
</section>
<section id="ginas-graph" class="level4">
<h4 class="anchored" data-anchor-id="ginas-graph">gina’s graph</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>education_levels <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ISCED_Level =</span> <span class="fu">case_when</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">==</span> <span class="dv">00</span> <span class="sc">~</span> <span class="st">"Still Studying"</span>,  <span class="co"># Separate category</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">==</span> <span class="dv">01</span> <span class="sc">~</span> <span class="st">"No Formal Education"</span>,  <span class="co"># No formal schooling</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">==</span> <span class="dv">98</span> <span class="sc">|</span> age_edu <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"Refused / Don't Know"</span>,  <span class="co"># Separate category</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&lt;</span> <span class="dv">5</span>  <span class="sc">~</span> <span class="st">"Pre-primary"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> age_edu <span class="sc">&lt;=</span> <span class="dv">10</span>  <span class="sc">~</span> <span class="st">"Primary"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> age_edu <span class="sc">&lt;=</span> <span class="dv">14</span>  <span class="sc">~</span> <span class="st">"Lower Secondary"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> age_edu <span class="sc">&lt;=</span> <span class="dv">18</span>  <span class="sc">~</span> <span class="st">"Upper Secondary"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> age_edu <span class="sc">&lt;=</span> <span class="dv">19</span>  <span class="sc">~</span> <span class="st">"Vocational"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    age_edu <span class="sc">&gt;=</span> <span class="dv">19</span>  <span class="sc">~</span> <span class="st">"Tertiary"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>education_summary <span class="ot">&lt;-</span> education_levels <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, ISCED_Level) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country, <span class="fu">desc</span>(Count))</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>education_spending_summary <span class="ot">&lt;-</span> education_summary <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(final_data <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">Primary_Spending =</span> <span class="fu">mean</span>(prim_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">Lower_Secondary_Spending =</span> <span class="fu">mean</span>(lose_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">Upper_Secondary_Spending =</span> <span class="fu">mean</span>(upse_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">Vocational_Spending =</span> <span class="fu">mean</span>(voc_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">Tertiary_Spending =</span> <span class="fu">mean</span>(ter_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>              ), <span class="at">by =</span> <span class="st">"country"</span>)  </span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="fu">hchart</span>(education_summary, <span class="st">"column"</span>, </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>       <span class="fu">hcaes</span>(<span class="at">x =</span> country, <span class="at">y =</span> Count, <span class="at">group =</span> ISCED_Level)) <span class="sc">%&gt;%</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_chart</span>(</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"column"</span>,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundColor =</span> <span class="fu">list</span>(</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">linearGradient =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="dv">0</span>, <span class="at">y1 =</span> <span class="dv">0</span>, <span class="at">x2 =</span> <span class="dv">0</span>, <span class="at">y2 =</span> <span class="dv">1</span>),</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">stops =</span> <span class="fu">list</span>(</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'white'</span>),    </span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="dv">1</span>, <span class="st">'white'</span>)     </span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_plotOptions</span>(<span class="at">column =</span> <span class="fu">list</span>(<span class="at">stacking =</span> <span class="st">"normal"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Enable stacking</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Highest Education Level Reached Per Country (Stacked)"</span>, </span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontSize =</span> <span class="st">"20px"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Country"</span>, <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)), </span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="at">rotation =</span> <span class="sc">-</span><span class="dv">45</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Number of Respondents"</span>, <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)), </span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)),</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="dv">1050</span>,</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">tickInterval =</span> <span class="dv">150</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a> <span class="fu">hc_colors</span>(<span class="fu">c</span>(<span class="st">"#3498db"</span>, <span class="st">"#f39c12"</span>, <span class="st">"#e74c3c"</span>, <span class="st">"#9b59b6"</span>, <span class="st">"#2ecc71"</span>, <span class="st">"#34495e"</span>, <span class="st">"#1abc9c"</span>, <span class="st">"#d35400"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hc_legend</span>(<span class="at">reversed =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">useHTML =</span> <span class="cn">TRUE</span>, </span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointFormat =</span> <span class="st">"&lt;b&gt;{point.country}&lt;/b&gt;&lt;br&gt;</span></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a><span class="st">                           Education Level: {point.ISCED_Level}&lt;br&gt;</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="st">                           Respondents: {point.y}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-0c907c5fd5c67e2c4fe0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0c907c5fd5c67e2c4fe0">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column","backgroundColor":{"linearGradient":{"x1":0,"y1":0,"x2":0,"y2":1},"stops":[[0,"white"],[1,"white"]]}},"title":{"text":"Highest Education Level Reached Per Country (Stacked)","style":{"color":"black","fontSize":"20px"}},"yAxis":{"title":{"text":"Number of Respondents","style":{"color":"black"}},"type":"linear","labels":{"style":{"color":"black"}},"max":1050,"tickInterval":150},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}},"column":{"stacking":"normal"}},"series":[{"name":"Lower Secondary","data":[{"country":"Austria","ISCED_Level":"Lower Secondary","Count":23,"y":23,"name":"Austria"},{"country":"Belgium","ISCED_Level":"Lower Secondary","Count":30,"y":30,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Lower Secondary","Count":26,"y":26,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Lower Secondary","Count":26,"y":26,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Lower Secondary","Count":70,"y":70,"name":"Cyprus"},{"country":"Czechia","ISCED_Level":"Lower Secondary","Count":5,"y":5,"name":"Czechia"},{"country":"Denmark","ISCED_Level":"Lower Secondary","Count":13,"y":13,"name":"Denmark"},{"country":"Estonia","ISCED_Level":"Lower Secondary","Count":28,"y":28,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Lower Secondary","Count":26,"y":26,"name":"Finland"},{"country":"France","ISCED_Level":"Lower Secondary","Count":74,"y":74,"name":"France"},{"country":"Greece","ISCED_Level":"Lower Secondary","Count":129,"y":129,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Lower Secondary","Count":148,"y":148,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Lower Secondary","Count":53,"y":53,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Lower Secondary","Count":145,"y":145,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Lower Secondary","Count":7,"y":7,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Lower Secondary","Count":39,"y":39,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Lower Secondary","Count":24,"y":24,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Lower Secondary","Count":130,"y":130,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Lower Secondary","Count":28,"y":28,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Lower Secondary","Count":29,"y":29,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Lower Secondary","Count":259,"y":259,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Lower Secondary","Count":72,"y":72,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Lower Secondary","Count":27,"y":27,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Lower Secondary","Count":232,"y":232,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Lower Secondary","Count":27,"y":27,"name":"Sweden"}],"type":"column"},{"name":"Pre-primary","data":[{"country":"Belgium","ISCED_Level":"Pre-primary","Count":4,"y":4,"name":"Belgium"},{"country":"Estonia","ISCED_Level":"Pre-primary","Count":1,"y":1,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Pre-primary","Count":2,"y":2,"name":"Finland"},{"country":"Greece","ISCED_Level":"Pre-primary","Count":2,"y":2,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Pre-primary","Count":1,"y":1,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Pre-primary","Count":3,"y":3,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Pre-primary","Count":5,"y":5,"name":"Italy"},{"country":"Poland","ISCED_Level":"Pre-primary","Count":7,"y":7,"name":"Poland"},{"country":"Romania","ISCED_Level":"Pre-primary","Count":1,"y":1,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Pre-primary","Count":1,"y":1,"name":"Slovenia"}],"type":"column"},{"name":"Primary","data":[{"country":"Belgium","ISCED_Level":"Primary","Count":2,"y":2,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Primary","Count":6,"y":6,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Primary","Count":8,"y":8,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Primary","Count":13,"y":13,"name":"Cyprus"},{"country":"Finland","ISCED_Level":"Primary","Count":1,"y":1,"name":"Finland"},{"country":"Greece","ISCED_Level":"Primary","Count":5,"y":5,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Primary","Count":3,"y":3,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Primary","Count":2,"y":2,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Primary","Count":32,"y":32,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Primary","Count":1,"y":1,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Primary","Count":5,"y":5,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Primary","Count":3,"y":3,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Primary","Count":4,"y":4,"name":"Malta"},{"country":"Poland","ISCED_Level":"Primary","Count":2,"y":2,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Primary","Count":66,"y":66,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Primary","Count":6,"y":6,"name":"Romania"},{"country":"Spain","ISCED_Level":"Primary","Count":48,"y":48,"name":"Spain"}],"type":"column"},{"name":"Refused / Don't Know","data":[{"country":"Austria","ISCED_Level":"Refused / Don't Know","Count":80,"y":80,"name":"Austria"},{"country":"Belgium","ISCED_Level":"Refused / Don't Know","Count":146,"y":146,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Refused / Don't Know","Count":56,"y":56,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Refused / Don't Know","Count":82,"y":82,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Refused / Don't Know","Count":23,"y":23,"name":"Cyprus"},{"country":"Czechia","ISCED_Level":"Refused / Don't Know","Count":47,"y":47,"name":"Czechia"},{"country":"Denmark","ISCED_Level":"Refused / Don't Know","Count":71,"y":71,"name":"Denmark"},{"country":"Estonia","ISCED_Level":"Refused / Don't Know","Count":56,"y":56,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Refused / Don't Know","Count":73,"y":73,"name":"Finland"},{"country":"France","ISCED_Level":"Refused / Don't Know","Count":66,"y":66,"name":"France"},{"country":"Greece","ISCED_Level":"Refused / Don't Know","Count":78,"y":78,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Refused / Don't Know","Count":17,"y":17,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Refused / Don't Know","Count":88,"y":88,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Refused / Don't Know","Count":123,"y":123,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Refused / Don't Know","Count":77,"y":77,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Refused / Don't Know","Count":74,"y":74,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Refused / Don't Know","Count":52,"y":52,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Refused / Don't Know","Count":20,"y":20,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Refused / Don't Know","Count":47,"y":47,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Refused / Don't Know","Count":63,"y":63,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Refused / Don't Know","Count":82,"y":82,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Refused / Don't Know","Count":102,"y":102,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Refused / Don't Know","Count":96,"y":96,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Refused / Don't Know","Count":91,"y":91,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Refused / Don't Know","Count":40,"y":40,"name":"Sweden"}],"type":"column"},{"name":"Still Studying","data":[{"country":"Austria","ISCED_Level":"Still Studying","Count":14,"y":14,"name":"Austria"},{"country":"Bulgaria","ISCED_Level":"Still Studying","Count":9,"y":9,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Still Studying","Count":2,"y":2,"name":"Croatia"},{"country":"Czechia","ISCED_Level":"Still Studying","Count":2,"y":2,"name":"Czechia"},{"country":"Estonia","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Estonia"},{"country":"France","ISCED_Level":"Still Studying","Count":2,"y":2,"name":"France"},{"country":"Hungary","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Still Studying","Count":7,"y":7,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Latvia"},{"country":"Luxembourg","ISCED_Level":"Still Studying","Count":4,"y":4,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Still Studying","Count":2,"y":2,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Still Studying","Count":9,"y":9,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Still Studying","Count":1,"y":1,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Still Studying","Count":2,"y":2,"name":"Sweden"}],"type":"column"},{"name":"Tertiary","data":[{"country":"Austria","ISCED_Level":"Tertiary","Count":250,"y":250,"name":"Austria"},{"country":"Belgium","ISCED_Level":"Tertiary","Count":452,"y":452,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Tertiary","Count":222,"y":222,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Tertiary","Count":207,"y":207,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Tertiary","Count":206,"y":206,"name":"Cyprus"},{"country":"Czechia","ISCED_Level":"Tertiary","Count":278,"y":278,"name":"Czechia"},{"country":"Denmark","ISCED_Level":"Tertiary","Count":802,"y":802,"name":"Denmark"},{"country":"Estonia","ISCED_Level":"Tertiary","Count":426,"y":426,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Tertiary","Count":618,"y":618,"name":"Finland"},{"country":"France","ISCED_Level":"Tertiary","Count":435,"y":435,"name":"France"},{"country":"Greece","ISCED_Level":"Tertiary","Count":345,"y":345,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Tertiary","Count":208,"y":208,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Tertiary","Count":382,"y":382,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Tertiary","Count":217,"y":217,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Tertiary","Count":389,"y":389,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Tertiary","Count":412,"y":412,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Tertiary","Count":265,"y":265,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Tertiary","Count":82,"y":82,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Tertiary","Count":541,"y":541,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Tertiary","Count":365,"y":365,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Tertiary","Count":178,"y":178,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Tertiary","Count":216,"y":216,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Tertiary","Count":322,"y":322,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Tertiary","Count":287,"y":287,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Tertiary","Count":719,"y":719,"name":"Sweden"}],"type":"column"},{"name":"Upper Secondary","data":[{"country":"Austria","ISCED_Level":"Upper Secondary","Count":458,"y":458,"name":"Austria"},{"country":"Belgium","ISCED_Level":"Upper Secondary","Count":306,"y":306,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Upper Secondary","Count":465,"y":465,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Upper Secondary","Count":540,"y":540,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Upper Secondary","Count":183,"y":183,"name":"Cyprus"},{"country":"Czechia","ISCED_Level":"Upper Secondary","Count":460,"y":460,"name":"Czechia"},{"country":"Denmark","ISCED_Level":"Upper Secondary","Count":56,"y":56,"name":"Denmark"},{"country":"Estonia","ISCED_Level":"Upper Secondary","Count":390,"y":390,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Upper Secondary","Count":240,"y":240,"name":"Finland"},{"country":"France","ISCED_Level":"Upper Secondary","Count":368,"y":368,"name":"France"},{"country":"Greece","ISCED_Level":"Upper Secondary","Count":443,"y":443,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Upper Secondary","Count":571,"y":571,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Upper Secondary","Count":421,"y":421,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Upper Secondary","Count":273,"y":273,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Upper Secondary","Count":416,"y":416,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Upper Secondary","Count":382,"y":382,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Upper Secondary","Count":127,"y":127,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Upper Secondary","Count":243,"y":243,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Upper Secondary","Count":312,"y":312,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Upper Secondary","Count":348,"y":348,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Upper Secondary","Count":382,"y":382,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Upper Secondary","Count":513,"y":513,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Upper Secondary","Count":361,"y":361,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Upper Secondary","Count":312,"y":312,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Upper Secondary","Count":150,"y":150,"name":"Sweden"}],"type":"column"},{"name":"Vocational","data":[{"country":"Austria","ISCED_Level":"Vocational","Count":202,"y":202,"name":"Austria"},{"country":"Belgium","ISCED_Level":"Vocational","Count":88,"y":88,"name":"Belgium"},{"country":"Bulgaria","ISCED_Level":"Vocational","Count":248,"y":248,"name":"Bulgaria"},{"country":"Croatia","ISCED_Level":"Vocational","Count":132,"y":132,"name":"Croatia"},{"country":"Cyprus","ISCED_Level":"Vocational","Count":8,"y":8,"name":"Cyprus"},{"country":"Czechia","ISCED_Level":"Vocational","Count":216,"y":216,"name":"Czechia"},{"country":"Denmark","ISCED_Level":"Vocational","Count":62,"y":62,"name":"Denmark"},{"country":"Estonia","ISCED_Level":"Vocational","Count":101,"y":101,"name":"Estonia"},{"country":"Finland","ISCED_Level":"Vocational","Count":43,"y":43,"name":"Finland"},{"country":"France","ISCED_Level":"Vocational","Count":62,"y":62,"name":"France"},{"country":"Greece","ISCED_Level":"Vocational","Count":14,"y":14,"name":"Greece"},{"country":"Hungary","ISCED_Level":"Vocational","Count":78,"y":78,"name":"Hungary"},{"country":"Ireland","ISCED_Level":"Vocational","Count":56,"y":56,"name":"Ireland"},{"country":"Italy","ISCED_Level":"Vocational","Count":221,"y":221,"name":"Italy"},{"country":"Latvia","ISCED_Level":"Vocational","Count":116,"y":116,"name":"Latvia"},{"country":"Lithuania","ISCED_Level":"Vocational","Count":91,"y":91,"name":"Lithuania"},{"country":"Luxembourg","ISCED_Level":"Vocational","Count":39,"y":39,"name":"Luxembourg"},{"country":"Malta","ISCED_Level":"Vocational","Count":15,"y":15,"name":"Malta"},{"country":"Netherlands","ISCED_Level":"Vocational","Count":85,"y":85,"name":"Netherlands"},{"country":"Poland","ISCED_Level":"Vocational","Count":194,"y":194,"name":"Poland"},{"country":"Portugal","ISCED_Level":"Vocational","Count":41,"y":41,"name":"Portugal"},{"country":"Romania","ISCED_Level":"Vocational","Count":122,"y":122,"name":"Romania"},{"country":"Slovenia","ISCED_Level":"Vocational","Count":200,"y":200,"name":"Slovenia"},{"country":"Spain","ISCED_Level":"Vocational","Count":34,"y":34,"name":"Spain"},{"country":"Sweden","ISCED_Level":"Vocational","Count":70,"y":70,"name":"Sweden"}],"type":"column"}],"xAxis":{"type":"category","title":{"text":"Country","style":{"color":"black"}},"labels":{"style":{"color":"black"},"rotation":-45}},"colors":["#3498db","#f39c12","#e74c3c","#9b59b6","#2ecc71","#34495e","#1abc9c","#d35400"],"legend":{"reversed":true},"tooltip":{"useHTML":true,"pointFormat":"<b>{point.country}<\/b><br>\n                           Education Level: {point.ISCED_Level}<br>\n                           Respondents: {point.y}"}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="distribution-of-responses-to-question-19" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-responses-to-question-19">Distribution of responses to Question 19…</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qc19 =</span> <span class="fu">as_factor</span>(qc19),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">as_factor</span>(d10))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>qc19_country_gender_dist <span class="ot">&lt;-</span> data<span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(isocntry, gender, qc19) <span class="sc">%&gt;%</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qc19_country_gender_dist, <span class="fu">aes</span>(<span class="at">x =</span> qc19, <span class="at">y =</span> count, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Dodge to separate gender groups</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>isocntry, <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span>  <span class="co"># Fix the y-axis across all countries</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Man"</span> <span class="ot">=</span> <span class="st">"#3C8BFA"</span>, <span class="st">"Woman"</span> <span class="ot">=</span> <span class="st">"#663CFA"</span>)) <span class="sc">+</span>  <span class="co"># Gender colors</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">400</span>), <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span>  <span class="co"># Set y-axis range and clip outside values</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of qc19 Responses by Country and Gender"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Response Type"</span>, <span class="at">y =</span> <span class="st">"Response Count"</span>, <span class="at">fill =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),  </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph shows the distribution of responses to question 19 (&nbsp;<code>qc19</code>&nbsp;) across different countries, split by gender.</p>
<p>It shows that, in some countries, men tend to give a higher number of “Yes” responses, while women tend to answer “No” or “Don’t Know” more frequently. This suggests that gender may influence how people answer the question in different regions.</p>
<p>In countries like Austria (AT), Great Britain (GB), and Spain (ES), responses are fairly balanced between genders. However, in countries such as Poland (PL) and Portugal (PT), one gender seems to dominate a particular response category, indicating a possible cultural or regional difference in how men and women approach the question.</p>
<p>Overall, Western European countries show more “Yes” responses, while Eastern European countries show higher proportions of “No” or “Don’t Know” responses. These differences might be influenced by societal or cultural factors.</p>
<p>This graph highlights the role of both gender and cultural context in shaping responses to the same question across different countries. Understanding these differences could offer insights into the social and cultural dynamics at play.</p>
<section id="by-gender" class="level5">
<h5 class="anchored" data-anchor-id="by-gender">…by gender</h5>
<p>We decided to visualize gender-based distribution to ensure that any systematic differences between male and female responses are identified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qc19_country_gender_dist, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> count, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>qc19) <span class="sc">+</span>  </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Man"</span> <span class="ot">=</span> <span class="st">"#3C8BFA"</span>, <span class="st">"Woman"</span> <span class="ot">=</span> <span class="st">"#663CFA"</span>)) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of qc19 Responses by Gender"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Response Count"</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This boxplot illustrates that women tend to have slightly higher counts across response categories (Yes, No, DK), as indicated by the median and interquartile range.<br>
The “DK” category shows a lower response count overall, with some outliers.<br>
The spread of responses is wider for Yes and No, indicating more variation in responses among men and women.</p>
</section>
<section id="by-country" class="level5">
<h5 class="anchored" data-anchor-id="by-country">…by country</h5>
<p>We wanted to visualize how responses to question 19 are distributed across different countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>isocntry <span class="ot">&lt;-</span> <span class="fu">reorder</span>(data<span class="sc">$</span>isocntry, <span class="fu">as.numeric</span>(data<span class="sc">$</span>qc19), mean)  <span class="co"># Order by mean qc19 response</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> isocntry, <span class="at">y =</span> <span class="fu">as.numeric</span>(qc19))) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">fill =</span> <span class="st">"#3C8BFA"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Make violins wider</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span>  <span class="co"># Add boxplot overlay</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Highlight means</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"DK"</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of qc19 Responses by Country (Ordered by Mean)"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"qc19 Response Score"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Adjust font size</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this <strong>violin plot</strong>, countries are ordered by the mean response score, which helps to compare countries based on their general tendency to answer the question. The red points highlighting the mean for each country provide a quick way to identify where each country stands in terms of overall response. This makes it easier to compare countries at a glance, much like the previous bar plot we used, but with more detailed distribution information.</p>
<p>While the previous bar plot helped us compare the responses between men and women across countries, this violin plot allows us to examine the distribution in more detail. In the bar plot, we could see that some countries had a higher count of “Yes” or “No” responses, but the violin plot provides a deeper understanding of how those responses are spread. For example, in some countries, the responses are tightly grouped around a specific value (like “Yes”), while in others, the responses are more spread out across “Yes”, “No”, and “DK”.</p>
<p>From the graph, it’s clear that there are significant differences in the response distributions across countries. In some countries, the “Yes” response is much more common, while in others, “No” responses dominate. For example, in some Western European countries (such as the UK and Spain), the “Yes” response is more frequent, while in Eastern European countries (like Poland and Romania), “No” responses are higher. This suggests that cultural and societal factors in each country might influence how people answer such questions.</p>
<p>Another notable observation regards the “Don’t Know” (DK) category: in some countries, especially in Northern Europe (like Sweden), there’s a higher frequency of “Don’t Know” responses. This could indicate that people in these countries are more uncertain or hesitant to provide a definitive answer.</p>
<p>Additionally, some countries have wider violin plots, which indicates that responses in those countries are more spread out, meaning people gave more varied answers. This could reflect a society with diverse opinions and viewpoints.</p>
<p>In conclusion, the differences across countries shed light on how cultural factors and societal norms influence responses to questions like this. Gender differences in responses also stand out in certain countries, suggesting that gender plays a significant role in how people answer, influenced by cultural and social contexts.</p>
</section>
</section>
</section>
<section id="country-level-data" class="level3">
<h3 class="anchored" data-anchor-id="country-level-data">(2) Country-Level Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>country_vars <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3c) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Support =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(transgender_civil_dc), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">GDP =</span> <span class="fu">mean</span>(gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Education_Expenditure =</span> <span class="fu">mean</span>(edu_exp_pct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Preprimary_Education =</span> <span class="fu">mean</span>(preprim_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Primary_Education =</span> <span class="fu">mean</span>(prim_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_Secondary_Education =</span> <span class="fu">mean</span>(lose_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_Secondary_Education =</span> <span class="fu">mean</span>(upse_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tertiary_Education =</span> <span class="fu">mean</span>(ter_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Vocational_Education =</span> <span class="fu">mean</span>(voc_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>final_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3c) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Support_Rate =</span> <span class="fu">mean</span>(transgender_civil_dc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Support_Rate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 2
   iso3c Support_Rate
   &lt;chr&gt;        &lt;dbl&gt;
 1 BGR           217.
 2 HUN           198.
 3 ROU           192.
 4 LTU           179.
 5 POL           179.
 6 CYP           178.
 7 LVA           175.
 8 ITA           172.
 9 EST           171.
10 CZE           168.
# ℹ 15 more rows</code></pre>
</div>
</div>
<section id="economic-summary" class="level4">
<h4 class="anchored" data-anchor-id="economic-summary">Economic Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>economic_summary <span class="ot">&lt;-</span> final_data <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_gdp =</span> <span class="fu">mean</span>(gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_edu_exp =</span> <span class="fu">mean</span>(edu_exp_pct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_preprim_exp =</span> <span class="fu">mean</span>(preprim_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_prim_exp =</span> <span class="fu">mean</span>(prim_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lose_exp =</span> <span class="fu">mean</span>(lose_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_upse_exp =</span> <span class="fu">mean</span>(upse_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_ter_exp =</span> <span class="fu">mean</span>(ter_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_voc_exp =</span> <span class="fu">mean</span>(voc_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(economic_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 9
   country  avg_gdp avg_edu_exp avg_preprim_exp avg_prim_exp avg_lose_exp
   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 Austria  4.43e11        5.22            86.6         90.8         96.0
 2 Belgium  5.37e11        6.33            93.0         94.6         97.2
 3 Bulgaria 6.86e10        4.20            94.7         94.1         94.6
 4 Croatia  6.15e10        3.92            93.3         92.5         92.7
 5 Cyprus   2.62e10        5.21            93.7         95.7         97.8
 6 Czechia  2.57e11        4.54            91.0         88.5         88.6
 7 Denmark  3.45e11        7.26            94.8         89.9         89.9
 8 Estonia  3.19e10        5.26            93.3         86.4         86.4
 9 Finland  2.67e11        6.42            92.1         85.1         85.0
10 France   2.72e12        5.35            92.4         91.7         91.4
# ℹ 15 more rows
# ℹ 3 more variables: avg_upse_exp &lt;dbl&gt;, avg_ter_exp &lt;dbl&gt;, avg_voc_exp &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>econ_data <span class="ot">&lt;-</span> final_data[, <span class="fu">c</span>(<span class="st">"gdp"</span>, <span class="st">"edu_exp_pct"</span>, <span class="st">"preprim_exp"</span>, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"prim_exp"</span>, <span class="st">"lose_exp"</span>, <span class="st">"upse_exp"</span>, <span class="st">"ter_exp"</span>, <span class="st">"voc_exp"</span>)]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>econ_long <span class="ot">&lt;-</span> econ_data <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(econ_long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Economical Variables "</span>, <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution of <strong>education expenditure as a percentage of GDP (edu_exp_pct)</strong> shows that most countries allocate between 4% and 6% of their GDP to education, with some outliers spending more than 7%. This suggests that education is a significant budget priority, but the variation indicates differing national policies and economic capabilities.</p>
<p>The <strong>GDP distribution</strong> is highly skewed, with most observations concentrated at lower values and a few countries with significantly higher GDPs. This highlights economic disparities among the nations in the dataset, where a small number of countries dominate in terms of economic output.</p>
<p>When examining <strong>education expenditure across different levels</strong>, lower secondary (lose_exp), upper secondary (upse_exp), and tertiary education (ter_exp) expenditures are concentrated in the 90-97% range. This suggests that most countries prioritize these educational stages, ensuring substantial funding. Primary education (prim_exp) also receives strong investment, with values largely between 85% and 100%, showing consistency in educational priorities.</p>
<p>On the other hand, <strong>pre-primary education expenditure (preprim_exp)</strong> displays a more dispersed distribution, though most values remain high, indicating recognition of the importance of early childhood education. In contrast, <strong>vocational education expenditure (voc_exp)</strong> exhibits a more varied pattern, with peaks at both 75% and 100%, suggesting that while some countries emphasize vocational training, others invest less in this area.</p>
<p>Overall, the distributions illustrate a global trend of strong financial commitment to general education, with some variations in economic capacity and prioritization of specific educational stages.</p>
</section>
<section id="gdp-vs.-education-expenditure" class="level4">
<h4 class="anchored" data-anchor-id="gdp-vs.-education-expenditure">GDP vs.&nbsp;Education Expenditure</h4>
<p>We wanted to analyze the relationship between GDP and total education spending across European countries. The dataset was first prepared by removing missing values and transforming GDP into trillions of USD. Education expenditure was computed as a percentage of GDP and converted into billions of USD. A categorical variable (“Spending_Category”) was created to classify spending into four levels: Low (&lt;20B), Medium (20B-50B), High (50B-100B), and Very High (&gt;100B).</p>
<p>We decided to visualize it as a bubble chart, where each point represents a country. The x-axis shows GDP (in trillions USD), while the y-axis displays total education spending (in billions USD). The size of each bubble corresponds to the amount spent on education, and colors indicate spending categories: blue for low, gold for medium, orange for high, and dark red for very high.</p>
<p>The chart was customized with an interactive tooltips displaying detailed country-level information, including the percentage of GDP allocated to education.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>data_2019 <span class="ot">&lt;-</span> edueco_data <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(NY.GDP.MKTP.CD, SE.XPD.TOTL.GD.ZS, country) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_trillions =</span> NY.GDP.MKTP.CD <span class="sc">/</span> <span class="fl">1e12</span>,  <span class="co"># Convert GDP to Trillions USD</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total_Education_Spending =</span> (NY.GDP.MKTP.CD <span class="sc">*</span> SE.XPD.TOTL.GD.ZS) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Spending_Billions =</span> Total_Education_Spending <span class="sc">/</span> <span class="fl">1e9</span>,  <span class="co"># Convert Spending to Billions USD</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Education_Percent_GDP =</span> <span class="fu">round</span>(SE.XPD.TOTL.GD.ZS, <span class="dv">2</span>),  <span class="co"># Round % of GDP spent on education</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Spending_Category =</span> <span class="fu">cut</span>(Spending_Billions, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="cn">Inf</span>), </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low (&lt;20B)"</span>, <span class="st">"Medium (20B-50B)"</span>, </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"High (50B-100B)"</span>, <span class="st">"Very High (&gt;100B)"</span>)))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Explicitly Define Colors for Categories</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>spending_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#1E90FF"</span>,  <span class="co"># Bright Blue (Low &lt;20B)</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#FFD700"</span>,  <span class="co"># Gold (Medium 20B-50B)</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#FF4500"</span>,  <span class="co"># Red-Orange (High 50B-100B)</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"#8B0000"</span>)  <span class="co"># Dark Red (Very High &gt;100B)</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the chart with gradient background and y-axis starting at 0</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hchart</span>(data_2019, <span class="st">"bubble"</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> GDP_trillions, <span class="at">y =</span> Spending_Billions, </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> Spending_Billions, <span class="at">group =</span> Spending_Category, </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">name =</span> country)) <span class="sc">%&gt;%</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_chart</span>(</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundColor =</span> <span class="fu">list</span>(</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">linearGradient =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="dv">0</span>, <span class="at">y1 =</span> <span class="dv">0</span>, <span class="at">x2 =</span> <span class="dv">0</span>, <span class="at">y2 =</span> <span class="dv">1</span>),</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">stops =</span> <span class="fu">list</span>(</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'white'</span>),    <span class="co"># Dark blue at the top</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="dv">1</span>, <span class="st">'white'</span>)     <span class="co"># Near black at the bottom</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Education Spending Patterns in Europe (2019)"</span>, </span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontSize =</span> <span class="st">"20px"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_subtitle</span>(<span class="at">text =</span> <span class="st">"Comparing GDP and Total Education Spending"</span>, </span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontSize =</span> <span class="st">"14px"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"GDP (Trillions USD)"</span>, <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)),</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)),</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">gridLineColor =</span> <span class="st">"#444444"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Total Education Spending (Billions USD)"</span>, </span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)),</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)),</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">gridLineColor =</span> <span class="st">"#444444"</span>,</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  <span class="co"># Set y-axis to start at 0</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(<span class="at">layout =</span> <span class="st">"horizontal"</span>, <span class="at">align =</span> <span class="st">"right"</span>, <span class="at">verticalAlign =</span> <span class="st">"bottom"</span>,</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">itemStyle =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply Colors Using hc_colors() </span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_colors</span>(spending_colors) <span class="sc">%&gt;%</span></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">useHTML =</span> <span class="cn">TRUE</span>, </span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">backgroundColor =</span> <span class="st">"white"</span>,  <span class="co"># White background</span></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">borderColor =</span> <span class="st">"black"</span>,</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">style =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontSize =</span> <span class="st">"14px"</span>),  <span class="co"># Ensure all text is black</span></span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">formatter =</span> <span class="fu">JS</span>(<span class="st">"function() {</span></span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a><span class="st">               return '&lt;b&gt;' + this.point.name + '&lt;/b&gt;&lt;br&gt;' +</span></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a><span class="st">                      '&lt;b&gt;GDP:&lt;/b&gt; ' + Highcharts.numberFormat(this.x, 2) + 'T USD&lt;br&gt;' +</span></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="st">                      '&lt;b&gt;Education Spending:&lt;/b&gt; ' + Highcharts.numberFormat(this.y, 2) + 'B USD&lt;br&gt;' +</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a><span class="st">                      '&lt;b&gt;% of GDP Spent on Education:&lt;/b&gt; ' + Highcharts.numberFormat(this.point.Education_Percent_GDP, 2) + '%&lt;br&gt;' +</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a><span class="st">                      '&lt;b&gt;Category:&lt;/b&gt; ' + this.series.name;</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a><span class="st">             }"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-542664768a1bfd6fe292" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-542664768a1bfd6fe292">{"x":{"hc_opts":{"chart":{"reflow":true,"backgroundColor":{"linearGradient":{"x1":0,"y1":0,"x2":0,"y2":1},"stops":[[0,"white"],[1,"white"]]}},"title":{"text":"Education Spending Patterns in Europe (2019)","style":{"color":"black","fontSize":"20px"}},"yAxis":{"title":{"text":"Total Education Spending (Billions USD)","style":{"color":"black"}},"type":"linear","labels":{"style":{"color":"black"}},"gridLineColor":"#444444","min":0},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"name":"Low (<20B)","data":[{"...1":3,"country":"Bulgaria","iso2c":"BG","iso3c":"BGR","year":2019,"NY.GDP.MKTP.CD":68631726289.2794,"SE.XPD.TOTL.GD.ZS":4.19902992248535,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":94.6580810546875,"Primary (XSPENDP.1.FDPUB.FNCUR)":94.114616394043,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":94.6241912841797,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":95.25258636474609,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":95.8466720581055,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":97.8260879516602,"x":0.06863172628927941,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":3,"facial.feminisation.surgery":3,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":2,"mastectomy":2,"metoidioplasty":3,"orchiectomy":3,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":3,"vaginoplasty":2,"vocal.training":3,"no legal framework making legal gender recognition impossible":0,"existence of legal measures":0,"existence of administrative procedures":0,"name change":0,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.06863172628927941,"Total_Education_Spending":2881866723.205087,"Spending_Billions":2.881866723205087,"Education_Percent_GDP":4.2,"Spending_Category":"Low (<20B)","y":2.881866723205087,"size":2.881866723205087,"name":"Bulgaria","z":2.881866723205087},{"...1":4,"country":"Croatia","iso2c":"HR","iso3c":"HRV","year":2019,"NY.GDP.MKTP.CD":61467582193.6824,"SE.XPD.TOTL.GD.ZS":3.92007994651794,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":null,"Primary (XSPENDP.1.FDPUB.FNCUR)":null,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":null,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":null,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":94.9645233154297,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":0,"x":0.0614675821936824,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":3,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":1,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":0,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.0614675821936824,"Total_Education_Spending":2409578363.183976,"Spending_Billions":2.409578363183976,"Education_Percent_GDP":3.92,"Spending_Category":"Low (<20B)","y":2.409578363183976,"size":2.409578363183976,"name":"Croatia","z":2.409578363183976},{"...1":5,"country":"Cyprus","iso2c":"CY","iso3c":"CYP","year":2019,"NY.GDP.MKTP.CD":26196667099.5303,"SE.XPD.TOTL.GD.ZS":5.21260023117065,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":93.6603317260742,"Primary (XSPENDP.1.FDPUB.FNCUR)":95.6630325317383,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":97.82582855224609,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":98.2220764160156,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":98.5888671875,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":0,"x":0.0261966670995303,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":3,"electrolysis...laser.hair.removal":3,"facial.feminisation.surgery":3,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":2,"mastectomy":1,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":3,"vaginoplasty":2,"vocal.training":3,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":0,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.0261966670995303,"Total_Education_Spending":1365527529.789122,"Spending_Billions":1.365527529789122,"Education_Percent_GDP":5.21,"Spending_Category":"Low (<20B)","y":1.365527529789122,"size":1.365527529789122,"name":"Cyprus","z":1.365527529789122},{"...1":6,"country":"Czechia","iso2c":"CZ","iso3c":"CZE","year":2019,"NY.GDP.MKTP.CD":256794209028.77,"SE.XPD.TOTL.GD.ZS":4.54246997833252,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":90.99066162109381,"Primary (XSPENDP.1.FDPUB.FNCUR)":88.451789855957,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":88.6386337280273,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":89.007080078125,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":89.4863204956055,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":88.3175582885742,"x":0.25679420902877,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.25679420902877,"Total_Education_Spending":11664799851.22833,"Spending_Billions":11.66479985122833,"Education_Percent_GDP":4.54,"Spending_Category":"Low (<20B)","y":11.66479985122833,"size":11.66479985122833,"name":"Czechia","z":11.66479985122833},{"...1":8,"country":"Estonia","iso2c":"EE","iso3c":"EST","year":2019,"NY.GDP.MKTP.CD":31873748770.0313,"SE.XPD.TOTL.GD.ZS":5.26041984558105,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":null,"Primary (XSPENDP.1.FDPUB.FNCUR)":86.40419006347661,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":86.40297698974609,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":89.18035888671881,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":92.75140380859381,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":90.4153213500977,"x":0.0318737487700313,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":3,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":2,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":3,"phalloplasty":2,"tracheal.shave":1,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.0318737487700313,"Total_Education_Spending":1676693005.829372,"Spending_Billions":1.676693005829372,"Education_Percent_GDP":5.26,"Spending_Category":"Low (<20B)","y":1.676693005829372,"size":1.676693005829372,"name":"Estonia","z":1.676693005829372},{"...1":9,"country":"Finland","iso2c":"FI","iso3c":"FIN","year":2019,"NY.GDP.MKTP.CD":267014821129.411,"SE.XPD.TOTL.GD.ZS":6.41695022583008,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":92.062629699707,"Primary (XSPENDP.1.FDPUB.FNCUR)":85.0665283203125,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":85.0258331298828,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":87.9585876464844,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":91.4612121582031,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":0.267014821129411,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.267014821129411,"Total_Education_Spending":17134208167.46352,"Spending_Billions":17.13420816746352,"Education_Percent_GDP":6.42,"Spending_Category":"Low (<20B)","y":17.13420816746352,"size":17.13420816746352,"name":"Finland","z":17.13420816746352},{"...1":12,"country":"Greece","iso2c":"GR","iso3c":"GRC","year":2019,"NY.GDP.MKTP.CD":207305649887.019,"SE.XPD.TOTL.GD.ZS":3.58612990379333,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":96.9251174926758,"Primary (XSPENDP.1.FDPUB.FNCUR)":97.8388290405273,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":97.9030685424805,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":97.28701019287109,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":96.6131210327148,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":99.5042266845703,"x":0.207305649887019,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":2,"facial.feminisation.surgery":3,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":3,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":3,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.207305649887019,"Total_Education_Spending":7434249902.851493,"Spending_Billions":7.434249902851493,"Education_Percent_GDP":3.59,"Spending_Category":"Low (<20B)","y":7.434249902851493,"size":7.434249902851493,"name":"Greece","z":7.434249902851493},{"...1":13,"country":"Hungary","iso2c":"HU","iso3c":"HUN","year":2019,"NY.GDP.MKTP.CD":164020460331.659,"SE.XPD.TOTL.GD.ZS":4.22488021850586,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":91.3058776855469,"Primary (XSPENDP.1.FDPUB.FNCUR)":93.6029434204102,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":94.114616394043,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":92.4022903442383,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":90.7241134643555,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":90.3383026123047,"x":0.164020460331659,"psychological.care":2,"psychiatric.care":2,"breast.augmentation":2,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":2,"hrt..oestrogen.":2,"hrt..testosterone.":2,"hysterectomy":2,"mastectomy":2,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":0,"existence of legal measures":0,"existence of administrative procedures":0,"name change":0,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.164020460331659,"Total_Education_Spending":6929667982.854513,"Spending_Billions":6.929667982854514,"Education_Percent_GDP":4.22,"Spending_Category":"Low (<20B)","y":6.929667982854514,"size":6.929667982854514,"name":"Hungary","z":6.929667982854514},{"...1":14,"country":"Ireland","iso2c":"IE","iso3c":"IRL","year":2019,"NY.GDP.MKTP.CD":407124824064.995,"SE.XPD.TOTL.GD.ZS":3.2961699962616,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":null,"Primary (XSPENDP.1.FDPUB.FNCUR)":90.2823181152344,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":93.031608581543,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":93.1970901489258,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":93.34442138671881,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":96.5563201904297,"x":0.407124824064995,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":2,"metoidioplasty":2,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":2,"tracheal.shave":1,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.407124824064995,"Total_Education_Spending":13419526298.16319,"Spending_Billions":13.41952629816319,"Education_Percent_GDP":3.3,"Spending_Category":"Low (<20B)","y":13.41952629816319,"size":13.41952629816319,"name":"Ireland","z":13.41952629816319},{"...1":16,"country":"Latvia","iso2c":"LV","iso3c":"LVA","year":2019,"NY.GDP.MKTP.CD":33099503950.847,"SE.XPD.TOTL.GD.ZS":4.43584012985229,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":94.495719909668,"Primary (XSPENDP.1.FDPUB.FNCUR)":82.9821701049805,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":83.1020812988281,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":81.38266754150391,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":79.9869766235352,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":76.63600921630859,"x":0.033099503950847,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":2,"electrolysis...laser.hair.removal":2,"facial.feminisation.surgery":2,"hrt..oestrogen.":2,"hrt..testosterone.":2,"hysterectomy":2,"mastectomy":2,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":2,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":0,"name change":1,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.033099503950847,"Total_Education_Spending":1468241079.033715,"Spending_Billions":1.468241079033715,"Education_Percent_GDP":4.44,"Spending_Category":"Low (<20B)","y":1.468241079033715,"size":1.468241079033715,"name":"Latvia","z":1.468241079033715},{"...1":17,"country":"Lithuania","iso2c":"LT","iso3c":"LTU","year":2019,"NY.GDP.MKTP.CD":55122066225.796,"SE.XPD.TOTL.GD.ZS":3.9640998840332,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":96.5153274536133,"Primary (XSPENDP.1.FDPUB.FNCUR)":93.4474411010742,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":93.89768218994141,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":93.69483947753911,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":93.204460144043,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":91.7698211669922,"x":0.055122066225796,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":2,"electrolysis...laser.hair.removal":2,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":2,"mastectomy":2,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":2,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":0,"existence of administrative procedures":1,"name change":0,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.055122066225796,"Total_Education_Spending":2185093763.333483,"Spending_Billions":2.185093763333483,"Education_Percent_GDP":3.96,"Spending_Category":"Low (<20B)","y":2.185093763333483,"size":2.185093763333483,"name":"Lithuania","z":2.185093763333483},{"...1":18,"country":"Luxembourg","iso2c":"LU","iso3c":"LUX","year":2019,"NY.GDP.MKTP.CD":69890505323.5842,"SE.XPD.TOTL.GD.ZS":3.73606991767883,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":87.34243011474609,"Primary (XSPENDP.1.FDPUB.FNCUR)":87.41493225097661,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":88.3918533325195,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":88.39227294921881,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":88.3926620483398,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":100,"x":0.06989050532358419,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":3,"mastectomy":3,"metoidioplasty":3,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":3,"tracheal.shave":3,"vaginoplasty":3,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.06989050532358419,"Total_Education_Spending":2611158144.70815,"Spending_Billions":2.61115814470815,"Education_Percent_GDP":3.74,"Spending_Category":"Low (<20B)","y":2.61115814470815,"size":2.61115814470815,"name":"Luxembourg","z":2.61115814470815},{"...1":19,"country":"Malta","iso2c":"MT","iso3c":"MLT","year":2019,"NY.GDP.MKTP.CD":16337793530.7788,"SE.XPD.TOTL.GD.ZS":4.8993501663208,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":97.5498809814453,"Primary (XSPENDP.1.FDPUB.FNCUR)":96.95497894287109,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":89.9880065917969,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":90.8070373535156,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":91.34889221191411,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":79.5758895874023,"x":0.0163377935307788,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":1,"GDP_trillions":0.0163377935307788,"Total_Education_Spending":800445714.52336,"Spending_Billions":0.80044571452336,"Education_Percent_GDP":4.9,"Spending_Category":"Low (<20B)","y":0.80044571452336,"size":0.80044571452336,"name":"Malta","z":0.80044571452336},{"...1":22,"country":"Portugal","iso2c":"PT","iso3c":"PRT","year":2019,"NY.GDP.MKTP.CD":240115970063.019,"SE.XPD.TOTL.GD.ZS":4.63002014160156,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":99.8903427124023,"Primary (XSPENDP.1.FDPUB.FNCUR)":99.6943435668945,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":95.9529113769531,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":95.93312835693359,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":95.9127502441406,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":0.240115970063019,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.240115970063019,"Total_Education_Spending":11117417777.11975,"Spending_Billions":11.11741777711975,"Education_Percent_GDP":4.63,"Spending_Category":"Low (<20B)","y":11.11741777711975,"size":11.11741777711975,"name":"Portugal","z":11.11741777711975},{"...1":23,"country":"Romania","iso2c":"RO","iso3c":"ROU","year":2019,"NY.GDP.MKTP.CD":251677082534.495,"SE.XPD.TOTL.GD.ZS":3.56695008277893,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":93.509880065918,"Primary (XSPENDP.1.FDPUB.FNCUR)":95.74172210693359,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":92.98191070556641,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":94.6784286499023,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":96.4976501464844,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":99.581428527832,"x":0.251677082534495,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":2,"electrolysis...laser.hair.removal":2,"facial.feminisation.surgery":2,"hrt..oestrogen.":2,"hrt..testosterone.":1,"hysterectomy":2,"mastectomy":2,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":2,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":0,"name change":0,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":0,"no compulsory sterilisation required":0,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.251677082534495,"Total_Education_Spending":8977195903.799767,"Spending_Billions":8.977195903799766,"Education_Percent_GDP":3.57,"Spending_Category":"Low (<20B)","y":8.977195903799766,"size":8.977195903799766,"name":"Romania","z":8.977195903799766},{"...1":25,"country":"Slovenia","iso2c":"SI","iso3c":"SVN","year":2019,"NY.GDP.MKTP.CD":53909922735.545,"SE.XPD.TOTL.GD.ZS":4.89153003692627,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":92.7706604003906,"Primary (XSPENDP.1.FDPUB.FNCUR)":93.4123229980469,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":93.4376220703125,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":93.4818801879883,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":93.52516937255859,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":0,"x":0.053909922735545,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":2,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":2,"phalloplasty":2,"tracheal.shave":1,"vaginoplasty":2,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":0,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.053909922735545,"Total_Education_Spending":2637020063.492928,"Spending_Billions":2.637020063492928,"Education_Percent_GDP":4.89,"Spending_Category":"Low (<20B)","y":2.637020063492928,"size":2.637020063492928,"name":"Slovenia","z":2.637020063492928}],"type":"bubble"},{"name":"Medium (20B-50B)","data":[{"...1":1,"country":"Austria","iso2c":"AT","iso3c":"AUT","year":2019,"NY.GDP.MKTP.CD":442983642371.842,"SE.XPD.TOTL.GD.ZS":5.21779012680054,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":86.5993728637695,"Primary (XSPENDP.1.FDPUB.FNCUR)":90.75319671630859,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":95.9584579467773,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":96.8953170776367,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":98.0724563598633,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":99.2502365112305,"x":0.442983642371842,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":0,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.442983642371842,"Total_Education_Spending":23113956755.01939,"Spending_Billions":23.11395675501939,"Education_Percent_GDP":5.22,"Spending_Category":"Medium (20B-50B)","y":23.11395675501939,"size":23.11395675501939,"name":"Austria","z":23.11395675501939},{"...1":2,"country":"Belgium","iso2c":"BE","iso3c":"BEL","year":2019,"NY.GDP.MKTP.CD":536726344405.489,"SE.XPD.TOTL.GD.ZS":6.33397006988525,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":93.020881652832,"Primary (XSPENDP.1.FDPUB.FNCUR)":94.5743789672852,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":97.17225646972661,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":96.7121124267578,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":96.4712371826172,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":0.5367263444054891,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.5367263444054891,"Total_Education_Spending":33996086011.8329,"Spending_Billions":33.9960860118329,"Education_Percent_GDP":6.33,"Spending_Category":"Medium (20B-50B)","y":33.9960860118329,"size":33.9960860118329,"name":"Belgium","z":33.9960860118329},{"...1":7,"country":"Denmark","iso2c":"DK","iso3c":"DNK","year":2019,"NY.GDP.MKTP.CD":345401473012.615,"SE.XPD.TOTL.GD.ZS":7.25505018234253,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":94.84499359130859,"Primary (XSPENDP.1.FDPUB.FNCUR)":89.8574523925781,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":89.8574523925781,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":92.3438720703125,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":94.17674255371089,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":0,"x":0.345401473012615,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":2,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.345401473012615,"Total_Education_Spending":25059050197.61551,"Spending_Billions":25.05905019761551,"Education_Percent_GDP":7.26,"Spending_Category":"Medium (20B-50B)","y":25.05905019761551,"size":25.05905019761551,"name":"Denmark","z":25.05905019761551},{"...1":20,"country":"Netherlands","iso2c":"NL","iso3c":"NLD","year":2019,"NY.GDP.MKTP.CD":928903005576.469,"SE.XPD.TOTL.GD.ZS":5.15986013412476,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":89.2520065307617,"Primary (XSPENDP.1.FDPUB.FNCUR)":89.3332214355469,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":88.9268112182617,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":89.029426574707,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":89.1612930297852,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":0.928903005576469,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.928903005576469,"Total_Education_Spending":47930095869.42693,"Spending_Billions":47.93009586942693,"Education_Percent_GDP":5.16,"Spending_Category":"Medium (20B-50B)","y":47.93009586942693,"size":47.93009586942693,"name":"Netherlands","z":47.93009586942693},{"...1":21,"country":"Poland","iso2c":"PL","iso3c":"POL","year":2019,"NY.GDP.MKTP.CD":602683770144.88,"SE.XPD.TOTL.GD.ZS":4.67881011962891,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":94.8776016235352,"Primary (XSPENDP.1.FDPUB.FNCUR)":94.16082763671881,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":94.16082763671881,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":93.923942565918,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":93.66029357910161,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":91.9408874511719,"x":0.6026837701448801,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":2,"orchiectomy":2,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":2,"tracheal.shave":2,"vaginoplasty":2,"vocal.training":3,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":0,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":0.6026837701448801,"Total_Education_Spending":28198429226.89968,"Spending_Billions":28.19842922689968,"Education_Percent_GDP":4.68,"Spending_Category":"Medium (20B-50B)","y":28.19842922689968,"size":28.19842922689968,"name":"Poland","z":28.19842922689968},{"...1":27,"country":"Sweden","iso2c":"SE","iso3c":"SWE","year":2019,"NY.GDP.MKTP.CD":532169294165.94,"SE.XPD.TOTL.GD.ZS":7.63851022720337,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":94.92201995849609,"Primary (XSPENDP.1.FDPUB.FNCUR)":95.300537109375,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":95.3093566894531,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":94.9449996948242,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":94.6308898925781,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":95.0257568359375,"x":0.5321692941659401,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":2,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":0.5321692941659401,"Total_Education_Spending":40649805960.90131,"Spending_Billions":40.64980596090131,"Education_Percent_GDP":7.64,"Spending_Category":"Medium (20B-50B)","y":40.64980596090131,"size":40.64980596090131,"name":"Sweden","z":40.64980596090131}],"type":"bubble"},{"name":"High (50B-100B)","data":[{"...1":15,"country":"Italy","iso2c":"IT","iso3c":"ITA","year":2019,"NY.GDP.MKTP.CD":2019606796583.53,"SE.XPD.TOTL.GD.ZS":4.09527015686035,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":88.47646331787109,"Primary (XSPENDP.1.FDPUB.FNCUR)":97.3400802612305,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":97.2568893432617,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":96.91860198974609,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":96.7052001953125,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":2.01960679658353,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":0,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":0,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":0,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":2.01960679658353,"Total_Education_Spending":82708354426.40862,"Spending_Billions":82.70835442640862,"Education_Percent_GDP":4.1,"Spending_Category":"High (50B-100B)","y":82.70835442640862,"size":82.70835442640862,"name":"Italy","z":82.70835442640862},{"...1":26,"country":"Spain","iso2c":"ES","iso3c":"ESP","year":2019,"NY.GDP.MKTP.CD":1403496387686.27,"SE.XPD.TOTL.GD.ZS":4.23021984100342,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":96.9245986938477,"Primary (XSPENDP.1.FDPUB.FNCUR)":96.89927673339839,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":97.63050842285161,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":97.2399597167969,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":96.90753173828119,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":null,"x":1.40349638768627,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":3,"facial.feminisation.surgery":3,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":1,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":1.40349638768627,"Total_Education_Spending":59370982659.67087,"Spending_Billions":59.37098265967087,"Education_Percent_GDP":4.23,"Spending_Category":"High (50B-100B)","y":59.37098265967087,"size":59.37098265967087,"name":"Spain","z":59.37098265967087}],"type":"bubble"},{"name":"Very High (>100B)","data":[{"...1":10,"country":"France","iso2c":"FR","iso3c":"FRA","year":2019,"NY.GDP.MKTP.CD":2722793515171.76,"SE.XPD.TOTL.GD.ZS":5.35443019866943,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":92.3601608276367,"Primary (XSPENDP.1.FDPUB.FNCUR)":91.653938293457,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":91.3667297363281,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":90.99049377441411,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":90.581916809082,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":91.2479705810547,"x":2.72279351517176,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":0,"no 'gender identity disorder' diagnosis/psychological opinion required":1,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":0,"legal gender recognition procedures exist for minors":0,"depathologisation":0,"GDP_trillions":2.72279351517176,"Total_Education_Spending":145790078223.7696,"Spending_Billions":145.7900782237696,"Education_Percent_GDP":5.35,"Spending_Category":"Very High (>100B)","y":145.7900782237696,"size":145.7900782237696,"name":"France","z":145.7900782237696},{"...1":11,"country":"Germany","iso2c":"DE","iso3c":"DEU","year":2019,"NY.GDP.MKTP.CD":3957208055215.68,"SE.XPD.TOTL.GD.ZS":5.11552000045776,"PrePrimary (XSPENDP.02.FDPUB.FNCUR)":86.1577224731445,"Primary (XSPENDP.1.FDPUB.FNCUR)":91.6491622924805,"LowerSecondary (XSPENDP.2.FDPUB.FNCUR)":92.5135192871094,"UpperSecondary (XSPENDP.2T3.FDPUB.FNCUR)":92.6933975219727,"Tertiary (XSPENDP.3.FDPUB.FNCUR)":93.06606292724609,"VocationalTraining (XSPENDP.4.FDPUB.FNCUR)":94.1205368041992,"x":3.95720805521568,"psychological.care":1,"psychiatric.care":1,"breast.augmentation":1,"electrolysis...laser.hair.removal":1,"facial.feminisation.surgery":1,"hrt..oestrogen.":1,"hrt..testosterone.":1,"hysterectomy":1,"mastectomy":1,"metoidioplasty":1,"orchiectomy":1,"ovariectomy..aka.oopherectomy.":1,"phalloplasty":1,"tracheal.shave":1,"vaginoplasty":1,"vocal.training":1,"no legal framework making legal gender recognition impossible":1,"existence of legal measures":1,"existence of administrative procedures":1,"name change":1,"no age restriction, name change":1,"self-determination":0,"non-binary recognition":1,"no 'gender identity disorder' diagnosis/psychological opinion required":0,"no compulsory medical intervention required":1,"no compulsory surgical intervention required":1,"no compulsory sterilisation required":1,"no compulsory divorce required":1,"no age restriction":1,"legal gender recognition procedures exist for minors":1,"depathologisation":0,"GDP_trillions":3.95720805521568,"Total_Education_Spending":202431769524.2837,"Spending_Billions":202.4317695242837,"Education_Percent_GDP":5.12,"Spending_Category":"Very High (>100B)","y":202.4317695242837,"size":202.4317695242837,"name":"Germany","z":202.4317695242837}],"type":"bubble"}],"xAxis":{"type":"linear","title":{"text":"GDP (Trillions USD)","style":{"color":"black"}},"labels":{"style":{"color":"black"}},"gridLineColor":"#444444"},"subtitle":{"text":"Comparing GDP and Total Education Spending","style":{"color":"black","fontSize":"14px"}},"legend":{"layout":"horizontal","align":"right","verticalAlign":"bottom","itemStyle":{"color":"black"}},"colors":["#1E90FF","#FFD700","#FF4500","#8B0000"],"tooltip":{"useHTML":true,"backgroundColor":"white","borderColor":"black","style":{"color":"black","fontSize":"14px"},"formatter":"function() {\n               return '<b>' + this.point.name + '<\/b><br>' +\n                      '<b>GDP:<\/b> ' + Highcharts.numberFormat(this.x, 2) + 'T USD<br>' +\n                      '<b>Education Spending:<\/b> ' + Highcharts.numberFormat(this.y, 2) + 'B USD<br>' +\n                      '<b>% of GDP Spent on Education:<\/b> ' + Highcharts.numberFormat(this.point.Education_Percent_GDP, 2) + '%<br>' +\n                      '<b>Category:<\/b> ' + this.series.name;\n             }"}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":["hc_opts.tooltip.formatter"],"jsHooks":[]}</script>
</div>
</div>
<p>The bubble chart confirms a clear positive correlation between GDP and education spending: countries with higher GDP tend to allocate more absolute funds to education. However, the proportion of GDP spent on education varies, with some lower-GDP countries dedicating a relatively high percentage. The majority of education spending is concentrated among wealthier nations, as indicated by the clustering of large red bubbles in the upper right quadrant. Lower-GDP countries (blue bubbles) have significantly lower absolute education budgets, likely due to economic constraints.</p>
<p>The variation in spending on education suggests differing national priorities, with some high-GDP nations allocating more funding than others. This highlights economic disparities and policy choices in education investment across Europe.</p>
</section>
<section id="health-variables" class="level4">
<h4 class="anchored" data-anchor-id="health-variables">Health Variables</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>health_vars_data <span class="ot">&lt;-</span>   final_data[,<span class="fu">c</span>(<span class="st">"psychological.care"</span>, <span class="st">"psychiatric.care"</span>, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"breast.augmentation"</span>, <span class="st">"electrolysis...laser.hair.removal"</span>, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"facial.feminisation.surgery"</span>, <span class="st">"hrt..oestrogen."</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"hrt..testosterone."</span>, <span class="st">"hysterectomy"</span>, <span class="st">"mastectomy"</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"metoidioplasty"</span>, <span class="st">"orchiectomy"</span>, <span class="st">"ovariectomy..aka.oopherectomy."</span>, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"phalloplasty"</span>, <span class="st">"tracheal.shave"</span>, <span class="st">"vaginoplasty"</span>, <span class="st">"vocal.training"</span>)]</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>health_vars_long <span class="ot">&lt;-</span>health_vars_data<span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(health_vars_long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">bins =</span> <span class="dv">25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>), <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span> </span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density Distribution of Health Service Variables"</span> , <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_bar(bins = 25, alpha = 0.7, color = "black", position =
"dodge"): Ignoring unknown parameters: `bins`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution of health service variables highlights varying levels of access and demand for different medical interventions. <strong>Hormone replacement therapies (HRT)</strong> for both <strong>testosterone and oestrogen</strong> appear to be widely utilized, with most values concentrated around 1, suggesting high accessibility or demand. Similarly, <strong>psychological and psychiatric care</strong> also show a high density at the lower values, indicating that these services are commonly accessed.</p>
<p>Among surgical procedures, <strong>breast augmentation, electrolysis (laser hair removal), facial feminization surgery, and vocal training</strong> show a skewed distribution towards lower values, suggesting that while some individuals access these services, they may not be as widely available or utilized. In contrast, more invasive procedures such as <strong>hysterectomy, mastectomy, metoidioplasty, orchiectomy, and phalloplasty</strong> exhibit a more spread-out distribution, possibly reflecting differences in medical eligibility, personal choice, or systemic barriers to access.</p>
<p>Lastly, <strong>tracheal shave and vaginoplasty</strong> follow similar patterns, with most density at the lower end, indicating that while these procedures are available, fewer individuals access them compared to psychological or hormonal treatments. Overall, the distribution suggests a tiered access to gender-affirming care, where non-surgical and hormonal interventions are more frequently used than complex surgical procedures.</p>
</section>
<section id="legal-variables" class="level4">
<h4 class="anchored" data-anchor-id="legal-variables">Legal Variables</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>legal_vars_data <span class="ot">&lt;-</span> final_data[,<span class="fu">c</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="st">"nolger"</span>, <span class="st">"exist_lgme"</span>, <span class="st">"exist_adm"</span>, <span class="st">"name_change"</span>, <span class="st">"nar_name_change"</span>,  <span class="st">"self_det"</span>, <span class="st">"nb_recog"</span>, <span class="st">"psych_diag"</span>, <span class="st">"med_interven"</span>, <span class="st">"surg_interven"</span>, <span class="st">"steril_req"</span>, </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"div_req"</span>, <span class="st">"age_restrict"</span>, <span class="st">"lgrp_minors"</span>,<span class="st">"depath"</span>) ]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>legal_vars_long <span class="ot">&lt;-</span>legal_vars_data<span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(legal_vars_long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>), <span class="at">oob =</span> scales<span class="sc">::</span>squish)<span class="sc">+</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Economical Variables "</span>, <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_bar(bins = 30, alpha = 0.7, color = "black"): Ignoring unknown
parameters: `bins`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution of <strong>legal and medical transition-related variables</strong> reflects significant variations in policy and accessibility across different aspects of gender recognition and intervention.</p>
<p>Variables such as <strong>self-determination (self_det), name change, and non-binary recognition (nb_recog)</strong> indicate a higher concentration at lower values, suggesting that these aspects of gender identity recognition are not widely accessible or standardized across regions. Similarly, <strong>medical intervention requirements (med_interven) and psychological diagnosis (psych_diag)</strong> show a higher density at the lower end, implying that in many cases, medical or psychiatric evaluation may not be a strict prerequisite for gender recognition.</p>
<p>On the other hand, <strong>age restrictions (age_restrict), sterilization requirements (steril_req), and surgical intervention mandates (surg_interven)</strong> appear less commonly enforced, as their distributions are more spread out, indicating variability in policy adoption. Additionally, <strong>the existence of legal gender marker options (exist_lgme) and recognition of gender for minors (lgrp_minors)</strong> suggest that while some countries have progressive measures in place, these rights are not universally accessible.</p>
<p>Overall, the data underscores the uneven distribution of gender recognition policies, where self-identification and name change procedures are more commonly available than more restrictive requirements such as sterilization or mandatory medical interventions.</p>
</section>
</section>
<section id="multicolinearity" class="level3">
<h3 class="anchored" data-anchor-id="multicolinearity">Multicolinearity</h3>
<section id="model-1" class="level4">
<h4 class="anchored" data-anchor-id="model-1">Model 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to an ordered factor</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>transgender_civil_dc1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_data<span class="sc">$</span>transgender_civil_dc, </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>), </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Oppose"</span>, <span class="st">"Don't Know"</span>, <span class="st">"Support"</span>),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>ideo1 <span class="ot">&lt;-</span> <span class="fu">scale</span>(final_data<span class="sc">$</span>ideo)  </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>control_settings <span class="ot">&lt;-</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>))</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span> <span class="fu">glmer</span>(transgender_civil_dc1 <span class="sc">~</span> gender <span class="sc">+</span> religion1 <span class="sc">+</span> ideo <span class="sc">+</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">|</span> iso3c), </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data, </span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> binomial, </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control_settings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.0118737 (tol = 0.002, component 1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?;Model is nearly unidentifiable: large eigenvalue ratio
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>model1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: transgender_civil_dc1 ~ gender + religion1 + ideo + (1 | iso3c)
   Data: final_data
      AIC       BIC    logLik  deviance  df.resid 
 27842.54  27996.01 -13902.27  27804.54     23779 
Random effects:
 Groups Name        Std.Dev.
 iso3c  (Intercept) 0.7912  
Number of obs: 23798, groups:  iso3c, 25
Fixed Effects:
                     (Intercept)                            gender  
                       -0.012965                          0.401103  
     religion1Orthodox Christian               religion1Protestant  
                       -0.126888                          0.132605  
        religion1Other Christian                   religion1Jewish  
                       -0.186981                         -0.066252  
          religion1Muslim - Shia           religion1Muslim - Sunni  
                       -0.129794                         -0.048033  
           religion1Other Muslim                     religion1Sikh  
                        0.004708                         -0.709333  
               religion1Buddhist                    religion1Hindu  
                        0.090542                         -0.434045  
                religion1Atheist  religion1Non believer / Agnostic  
                        0.553280                          0.429908  
                  religion1Other                  religion1Refusal  
                        0.107003                          0.253529  
             religion1Don't Know                              ideo  
                       -0.123017                          0.001163  
optimizer (bobyqa) convergence code: 0 (OK) ; 0 optimizer warnings; 3 lme4 warnings </code></pre>
</div>
</div>
<p>The results of the generalized linear mixed model (GLMM) provide key insights into the factors influencing support for transgender rights while accounting for country-level variations. The model was estimated using a binomial logistic regression approach, with gender, religion, and ideology as fixed effects, and country-level variations modeled as random intercepts.</p>
<p>The model fit statistics indicate a reasonable fit to the data, with an AIC of 27842.54 and a BIC of 27996.01. The log-likelihood value (-13902.27) and deviance (27804.54) further confirm the model’s adequacy. The random intercept variance (0.7912) suggests substantial cross-country variation in support for transgender rights, indicating that country-level factors play a significant role in shaping attitudes.</p>
<p>Among the fixed effects, <strong>gender</strong> emerges as a significant predictor of support, with women being more likely to support transgender rights than men (β = 0.4012). <strong>Religious affiliation</strong> also plays a crucial role: Orthodox Christians (-0.127), Sunni Muslims (-0.048), and Shia Muslims (-0.130) show lower support compared to other religious groups, whereas <strong>Atheists (0.554) and Agnostics (0.430) display higher levels of support.</strong> Protestant Christians (0.133) and Buddhists (0.091) exhibit moderate support, while Hindus (-0.434) demonstrate a lower likelihood of endorsing transgender rights. These results indicate that <strong>more secular individuals are more supportive of transgender rights, whereas traditionally religious groups tend to be less supportive.</strong></p>
<p><strong>Ideology (β = 0.0411) positively correlates with support for transgender rights</strong>, meaning that as individuals become more progressive or left-leaning, their likelihood of supporting transgender rights increases. However, the effect size is relatively small, suggesting that while ideology matters, it is not a primary determinant.</p>
<p>Overall, the findings indicate that <strong>gender, religion, and ideology significantly shape attitudes toward transgender rights, with notable cross-country differences.</strong> Women and secular individuals are more likely to support transgender rights, while religious conservatism is associated with lower support. The presence of substantial <strong>country-level variation suggests that national context and cultural factors should be further explored in future research.</strong> Future models could benefit from incorporating additional individual-level variables such as age, education, and socioeconomic status, as well as exploring interactions between religion, ideology, and country-specific characteristics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(model1, <span class="at">type =</span> <span class="st">"est"</span>, <span class="at">show.values =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Effect of Variables on Support for Transgender Rights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualisation provides a clearer picture of what influences support for transgender rights. <strong>Women (OR = 1.49, p &lt; 0.001)</strong> are significantly more likely to be supportive compared to men, reinforcing the idea that gender plays a key role in shaping attitudes.</p>
<p>Religious beliefs also make a big difference. <strong>Atheists (OR = 1.74, p &lt; 0.001) and non-believers/agnostics (OR = 1.54, p &lt; 0.001)</strong> are much more likely to support transgender rights, while <strong>Hindus (OR = 0.65) and Sikhs (OR = 0.49)</strong> show lower support. Other religious groups, such as Orthodox Christians, Protestants, and Muslims, show more mixed results, meaning their views vary within their communities.</p>
<p><strong>Political ideology (OR = 1.04, p &lt; 0.01)</strong> also plays a role—people with more progressive views tend to be more supportive, though the effect is smaller compared to gender and religion.</p>
<p>Overall, this model highlights that <strong>gender and secular beliefs are strong predictors of support, while religious affiliation and ideology also shape opinions in meaningful ways.</strong> There’s still variation across groups, showing how complex attitudes toward transgender rights can be depending on social and cultural backgrounds.</p>
<section id="vif" class="level5">
<h5 class="anchored" data-anchor-id="vif">VIF</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model1)  <span class="co"># Calculate VIF for each predictor</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_values)  <span class="co"># Display results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              GVIF Df GVIF^(1/(2*Df))
gender    1.013216  1        1.006586
religion1 1.025183 15        1.000829
ideo      1.015643  1        1.007791</code></pre>
</div>
</div>
<p>The <strong>GVIF values</strong> indicate that multicollinearity is not a concern in this model, as all values are close to 1. This suggests that gender, religion, and ideology do not exhibit a strong linear relationship with one another, minimizing the risk of multicollinearity affecting the model’s estimates.</p>
<p>However, the <strong>residuals vs.&nbsp;fitted values plot</strong> displays a noticeable curvature rather than a random distribution, indicating a potential issue with model specification. Ideally, residuals should be randomly dispersed around zero, but the observed pattern suggests that the assumptions of <strong>homoscedasticity and linearity</strong> may not be met. This issue could be addressed by considering alternative model specifications, such as a <strong>probit model</strong> instead of a logit model, or by incorporating <strong>interaction terms</strong> to account for potential non-linear relationships.</p>
</section>
</section>
<section id="model-2" class="level4">
<h4 class="anchored" data-anchor-id="model-2">Model 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with a quadratic term for gender</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>gender_squared <span class="ot">&lt;-</span> final_data<span class="sc">$</span>gender<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(transgender_civil_dc1 <span class="sc">~</span> gender <span class="sc">+</span> gender_squared <span class="sc">+</span> religion1 <span class="sc">+</span> ideo1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> iso3c),</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> binomial,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2, <span class="at">correlation =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: transgender_civil_dc1 ~ gender + gender_squared + religion1 +  
    ideo1 + (1 | iso3c)
   Data: final_data
Control: glmerControl(optimizer = "bobyqa")

     AIC      BIC   logLik deviance df.resid 
 27842.5  27996.0 -13902.3  27804.5    23779 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3161 -0.9351  0.4621  0.7148  2.1783 

Random effects:
 Groups Name        Variance Std.Dev.
 iso3c  (Intercept) 0.626    0.7912  
Number of obs: 23798, groups:  iso3c, 25

Fixed effects:
                                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                       0.012798   0.167157   0.077  0.93897    
gender                            0.401243   0.029587  13.561  &lt; 2e-16 ***
religion1Orthodox Christian      -0.127007   0.070714  -1.796  0.07248 .  
religion1Protestant               0.132733   0.072147   1.840  0.06580 .  
religion1Other Christian         -0.187102   0.082222  -2.276  0.02287 *  
religion1Jewish                  -0.066283   0.324968  -0.204  0.83838    
religion1Muslim - Shia           -0.129892   0.263312  -0.493  0.62180    
religion1Muslim - Sunni          -0.048070   0.196836  -0.244  0.80707    
religion1Other Muslim             0.004691   0.199623   0.024  0.98125    
religion1Sikh                    -0.709438   0.857589  -0.827  0.40810    
religion1Buddhist                 0.090596   0.310496   0.292  0.77046    
religion1Hindu                   -0.434429   0.491753  -0.883  0.37700    
religion1Atheist                  0.553750   0.065780   8.418  &lt; 2e-16 ***
religion1Non believer / Agnostic  0.430239   0.055001   7.822 5.19e-15 ***
religion1Other                    0.107170   0.076780   1.396  0.16277    
religion1Refusal                  0.253783   0.137252   1.849  0.06445 .  
religion1Don't Know              -0.123187   0.192934  -0.638  0.52315    
ideo1                             0.041115   0.015083   2.726  0.00641 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
             (Intr) gender rlgn1OrC rlgn1P rlgn1OtC rlgn1J rlgn1Mslm-Sh
gender       -0.275                                                    
rlgn1OrthdC  -0.109 -0.008                                             
rlgn1Prtstn  -0.094  0.009  0.238                                      
rlgn1OthrCh  -0.071  0.013  0.221    0.279                             
relign1Jwsh  -0.014  0.008  0.031    0.039  0.029                      
rlgn1Mslm-Sh -0.021  0.016  0.074    0.040  0.034    0.008             
rlgn1Mslm-Sn -0.033  0.015  0.150    0.077  0.058    0.012  0.027      
rlgn1OthrMs  -0.030  0.011  0.146    0.064  0.053    0.011  0.026      
religin1Skh  -0.004  0.000  0.009    0.015  0.010    0.002  0.002      
rlgn1Bddhst  -0.016  0.012  0.029    0.043  0.030    0.007  0.009      
religin1Hnd  -0.014  0.017  0.026    0.032  0.023    0.004  0.004      
relgn1Athst  -0.091  0.072  0.210    0.257  0.191    0.035  0.046      
rlgn1Nnbl/A  -0.109  0.075  0.239    0.333  0.246    0.045  0.052      
relign1Othr  -0.072  0.024  0.208    0.243  0.190    0.030  0.037      
relign1Rfsl  -0.038  0.019  0.142    0.089  0.075    0.015  0.022      
rlgn1Dn'tKn  -0.030  0.008  0.120    0.086  0.079    0.010  0.017      
ideo1         0.010 -0.043 -0.001    0.017 -0.006    0.002  0.002      
             rlgn1Mslm-Sn rlg1OM rlgn1S rlgn1B rlgn1H rlgn1A r1Nb/A rlgn1O
gender                                                                    
rlgn1OrthdC                                                               
rlgn1Prtstn                                                               
rlgn1OthrCh                                                               
relign1Jwsh                                                               
rlgn1Mslm-Sh                                                              
rlgn1Mslm-Sn                                                              
rlgn1OthrMs   0.049                                                       
religin1Skh   0.003        0.003                                          
rlgn1Bddhst   0.012        0.011  0.003                                   
religin1Hnd   0.008        0.006  0.001  0.005                            
relgn1Athst   0.069        0.066  0.012  0.039  0.024                     
rlgn1Nnbl/A   0.078        0.071  0.015  0.049  0.031  0.280              
relign1Othr   0.060        0.056  0.011  0.033  0.022  0.197  0.247       
relign1Rfsl   0.040        0.042  0.006  0.017  0.009  0.082  0.100  0.076
rlgn1Dn'tKn   0.033        0.033  0.002  0.010  0.009  0.072  0.088  0.070
ideo1        -0.008       -0.033  0.007  0.014 -0.001  0.019  0.005  0.005
             rlgn1R rl1D'K
gender                    
rlgn1OrthdC               
rlgn1Prtstn               
rlgn1OthrCh               
relign1Jwsh               
rlgn1Mslm-Sh              
rlgn1Mslm-Sn              
rlgn1OthrMs               
religin1Skh               
rlgn1Bddhst               
religin1Hnd               
relgn1Athst               
rlgn1Nnbl/A               
relign1Othr               
relign1Rfsl               
rlgn1Dn'tKn   0.038       
ideo1        -0.087 -0.058
fit warnings:
fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get covariance matrix for the fixed effects coefficients</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>18 x 18 Matrix of class "dpoMatrix"
                                   (Intercept)        gender
(Intercept)                       2.794135e-02 -1.357612e-03
gender                           -1.357612e-03  8.754199e-04
religion1Orthodox Christian      -1.286522e-03 -1.682094e-05
religion1Protestant              -1.137663e-03  1.895871e-05
religion1Other Christian         -9.824999e-04  3.042239e-05
religion1Jewish                  -7.540179e-04  7.894546e-05
religion1Muslim - Shia           -9.373144e-04  1.220270e-04
religion1Muslim - Sunni          -1.073639e-03  8.840168e-05
religion1Other Muslim            -1.012614e-03  6.649049e-05
religion1Sikh                    -5.407821e-04 -1.149043e-05
religion1Buddhist                -8.446907e-04  1.128464e-04
religion1Hindu                   -1.122793e-03  2.505090e-04
religion1Atheist                 -1.002987e-03  1.403040e-04
religion1Non believer / Agnostic -1.001747e-03  1.227305e-04
religion1Other                   -9.277039e-04  5.451124e-05
religion1Refusal                 -8.656614e-04  7.682939e-05
religion1Don't Know              -9.691945e-04  4.443238e-05
ideo1                             2.551395e-05 -1.932988e-05
                                 religion1Orthodox Christian
(Intercept)                                    -1.286522e-03
gender                                         -1.682094e-05
religion1Orthodox Christian                     5.000508e-03
religion1Protestant                             1.215292e-03
religion1Other Christian                        1.282551e-03
religion1Jewish                                 7.046994e-04
religion1Muslim - Shia                          1.376286e-03
religion1Muslim - Sunni                         2.087055e-03
religion1Other Muslim                           2.064600e-03
religion1Sikh                                   5.538225e-04
religion1Buddhist                               6.476980e-04
religion1Hindu                                  9.048660e-04
religion1Atheist                                9.752107e-04
religion1Non believer / Agnostic                9.289025e-04
religion1Other                                  1.126816e-03
religion1Refusal                                1.383044e-03
religion1Don't Know                             1.637014e-03
ideo1                                          -1.506333e-06
                                 religion1Protestant religion1Other Christian
(Intercept)                            -1.137663e-03            -9.824999e-04
gender                                  1.895871e-05             3.042239e-05
religion1Orthodox Christian             1.215292e-03             1.282551e-03
religion1Protestant                     5.205193e-03             1.653665e-03
religion1Other Christian                1.653665e-03             6.760531e-03
religion1Jewish                         9.196394e-04             7.792630e-04
religion1Muslim - Shia                  7.677791e-04             7.392490e-04
religion1Muslim - Sunni                 1.087622e-03             9.370845e-04
religion1Other Muslim                   9.252264e-04             8.707158e-04
religion1Sikh                           9.392588e-04             6.721861e-04
religion1Buddhist                       9.535834e-04             7.745616e-04
religion1Hindu                          1.148902e-03             9.168205e-04
religion1Atheist                        1.218407e-03             1.031842e-03
religion1Non believer / Agnostic        1.323015e-03             1.113746e-03
religion1Other                          1.345910e-03             1.198201e-03
religion1Refusal                        8.841962e-04             8.444632e-04
religion1Don't Know                     1.191856e-03             1.251318e-03
ideo1                                   1.856066e-05            -7.425174e-06
                                 religion1Jewish religion1Muslim - Shia
(Intercept)                        -7.540179e-04          -0.0009373144
gender                              7.894546e-05           0.0001220270
religion1Orthodox Christian         7.046994e-04           0.0013762858
religion1Protestant                 9.196394e-04           0.0007677791
religion1Other Christian            7.792630e-04           0.0007392490
religion1Jewish                     1.056040e-01           0.0006513071
religion1Muslim - Shia              6.513071e-04           0.0693331710
religion1Muslim - Sunni             7.531767e-04           0.0013934411
religion1Other Muslim               6.947538e-04           0.0013438572
religion1Sikh                       5.996296e-04           0.0005085159
religion1Buddhist                   7.464638e-04           0.0007114122
religion1Hindu                      5.714593e-04           0.0005080563
religion1Atheist                    7.395918e-04           0.0008023291
religion1Non believer / Agnostic    7.991383e-04           0.0007483913
religion1Other                      7.405822e-04           0.0007510632
religion1Refusal                    6.801914e-04           0.0007886627
religion1Don't Know                 6.282693e-04           0.0008680499
ideo1                               7.815590e-06           0.0000098605
                                 religion1Muslim - Sunni religion1Other Muslim
(Intercept)                                -1.073639e-03         -1.012614e-03
gender                                      8.840168e-05          6.649049e-05
religion1Orthodox Christian                 2.087055e-03          2.064600e-03
religion1Protestant                         1.087622e-03          9.252264e-04
religion1Other Christian                    9.370845e-04          8.707158e-04
religion1Jewish                             7.531767e-04          6.947538e-04
religion1Muslim - Shia                      1.393441e-03          1.343857e-03
religion1Muslim - Sunni                     3.874459e-02          1.927588e-03
religion1Other Muslim                       1.927588e-03          3.984934e-02
religion1Sikh                               4.408729e-04          5.361095e-04
religion1Buddhist                           7.529394e-04          6.988791e-04
religion1Hindu                              7.960848e-04          6.255055e-04
religion1Atheist                            8.958151e-04          8.620157e-04
religion1Non believer / Agnostic            8.439766e-04          7.833154e-04
religion1Other                              9.111995e-04          8.592175e-04
religion1Refusal                            1.084312e-03          1.143150e-03
religion1Don't Know                         1.268788e-03          1.263566e-03
ideo1                                      -2.303292e-05         -1.004623e-04
                                 religion1Sikh religion1Buddhist religion1Hindu
(Intercept)                      -5.407821e-04     -8.446907e-04  -1.122793e-03
gender                           -1.149043e-05      1.128464e-04   2.505090e-04
religion1Orthodox Christian       5.538225e-04      6.476980e-04   9.048660e-04
religion1Protestant               9.392588e-04      9.535834e-04   1.148902e-03
religion1Other Christian          6.721861e-04      7.745616e-04   9.168205e-04
religion1Jewish                   5.996296e-04      7.464638e-04   5.714593e-04
religion1Muslim - Shia            5.085159e-04      7.114122e-04   5.080563e-04
religion1Muslim - Sunni           4.408729e-04      7.529394e-04   7.960848e-04
religion1Other Muslim             5.361095e-04      6.988791e-04   6.255055e-04
religion1Sikh                     7.354583e-01      7.607227e-04   3.038658e-04
religion1Buddhist                 7.607227e-04      9.640771e-02   8.084655e-04
religion1Hindu                    3.038658e-04      8.084655e-04   2.418212e-01
religion1Atheist                  6.627118e-04      7.872790e-04   7.878933e-04
religion1Non believer / Agnostic  7.089153e-04      8.367042e-04   8.450019e-04
religion1Other                    6.941635e-04      7.807603e-04   8.122309e-04
religion1Refusal                  7.527945e-04      7.129027e-04   6.399435e-04
religion1Don't Know               2.604843e-04      6.227508e-04   8.703303e-04
ideo1                             8.763628e-05      6.399378e-05  -7.822025e-06
                                 religion1Atheist
(Intercept)                         -1.002987e-03
gender                               1.403040e-04
religion1Orthodox Christian          9.752107e-04
religion1Protestant                  1.218407e-03
religion1Other Christian             1.031842e-03
religion1Jewish                      7.395918e-04
religion1Muslim - Shia               8.023291e-04
religion1Muslim - Sunni              8.958151e-04
religion1Other Muslim                8.620157e-04
religion1Sikh                        6.627118e-04
religion1Buddhist                    7.872790e-04
religion1Hindu                       7.878933e-04
religion1Atheist                     4.327034e-03
religion1Non believer / Agnostic     1.014409e-03
religion1Other                       9.945113e-04
religion1Refusal                     7.414595e-04
religion1Don't Know                  9.107079e-04
ideo1                                1.841052e-05
                                 religion1Non believer / Agnostic
(Intercept)                                         -1.001747e-03
gender                                               1.227305e-04
religion1Orthodox Christian                          9.289025e-04
religion1Protestant                                  1.323015e-03
religion1Other Christian                             1.113746e-03
religion1Jewish                                      7.991383e-04
religion1Muslim - Shia                               7.483913e-04
religion1Muslim - Sunni                              8.439766e-04
religion1Other Muslim                                7.833154e-04
religion1Sikh                                        7.089153e-04
religion1Buddhist                                    8.367042e-04
religion1Hindu                                       8.450019e-04
religion1Atheist                                     1.014409e-03
religion1Non believer / Agnostic                     3.025151e-03
religion1Other                                       1.043783e-03
religion1Refusal                                     7.554188e-04
religion1Don't Know                                  9.316195e-04
ideo1                                                4.479233e-06
                                 religion1Other religion1Refusal
(Intercept)                       -9.277039e-04    -8.656614e-04
gender                             5.451124e-05     7.682939e-05
religion1Orthodox Christian        1.126816e-03     1.383044e-03
religion1Protestant                1.345910e-03     8.841962e-04
religion1Other Christian           1.198201e-03     8.444632e-04
religion1Jewish                    7.405822e-04     6.801914e-04
religion1Muslim - Shia             7.510632e-04     7.886627e-04
religion1Muslim - Sunni            9.111995e-04     1.084312e-03
religion1Other Muslim              8.592175e-04     1.143150e-03
religion1Sikh                      6.941635e-04     7.527945e-04
religion1Buddhist                  7.807603e-04     7.129027e-04
religion1Hindu                     8.122309e-04     6.399435e-04
religion1Atheist                   9.945113e-04     7.414595e-04
religion1Non believer / Agnostic   1.043783e-03     7.554188e-04
religion1Other                     5.895124e-03     8.043803e-04
religion1Refusal                   8.043803e-04     1.883824e-02
religion1Don't Know                1.044208e-03     9.958508e-04
ideo1                              6.196900e-06    -1.798330e-04
                                 religion1Don't Know         ideo1
(Intercept)                            -9.691945e-04  2.551395e-05
gender                                  4.443238e-05 -1.932988e-05
religion1Orthodox Christian             1.637014e-03 -1.506333e-06
religion1Protestant                     1.191856e-03  1.856066e-05
religion1Other Christian                1.251318e-03 -7.425174e-06
religion1Jewish                         6.282693e-04  7.815590e-06
religion1Muslim - Shia                  8.680499e-04  9.860500e-06
religion1Muslim - Sunni                 1.268788e-03 -2.303292e-05
religion1Other Muslim                   1.263566e-03 -1.004623e-04
religion1Sikh                           2.604843e-04  8.763628e-05
religion1Buddhist                       6.227508e-04  6.399378e-05
religion1Hindu                          8.703303e-04 -7.822025e-06
religion1Atheist                        9.107079e-04  1.841052e-05
religion1Non believer / Agnostic        9.316195e-04  4.479233e-06
religion1Other                          1.044208e-03  6.196900e-06
religion1Refusal                        9.958508e-04 -1.798330e-04
religion1Don't Know                     3.722335e-02 -1.695148e-04
ideo1                                  -1.695148e-04  2.275112e-04</code></pre>
</div>
</div>
<p>The results from the ordered logistic regression model show that <strong>gender</strong>, <strong>religion</strong>, and <strong>ideology</strong> are significant predictors of support for transgender rights.</p>
<p>First, <strong>gender</strong> has a small positive effect on transgender rights support, with a coefficient of <strong>0.000875</strong>. This suggests that women are slightly more likely to support transgender rights compared to men, although the effect size is relatively small, indicating that gender alone may not be a strong predictor.</p>
<p><strong>Religion</strong> plays a larger role in shaping attitudes toward transgender rights. <strong>Atheists (0.004328)</strong> and <strong>Non-believers/Agnostics (0.003025)</strong> show a strong positive effect, indicating that individuals who identify as non-religious are significantly more likely to support transgender rights compared to religious groups. In contrast, <strong>Orthodox Christians (-0.001287)</strong>, <strong>Muslim-Sunni (-0.001074)</strong>, and <strong>Muslim-Shia (-0.000937)</strong> show negative coefficients, suggesting that these religious groups tend to have lower support for transgender rights. Interestingly, <strong>Protestants (0.005205)</strong> and <strong>Other Christians (0.006760)</strong> exhibit a positive relationship with support, meaning that Christians, particularly Protestants, are more likely to express support for transgender rights compared to Orthodox Christians.</p>
<p>The <strong>ideology</strong> variable shows a small positive effect (<strong>0.0000255</strong>), suggesting that more progressive ideologies are associated with increased support for transgender rights. However, the effect is quite small, meaning that political ideology has a relatively minor influence on support compared to gender and religion.</p>
<p>The <strong>interaction terms</strong> reveal that <strong>gender and religion together</strong> significantly influence attitudes toward transgender rights. For example, <strong>women in Orthodox Christian communities (0.001966)</strong> and <strong>Sikh communities (0.007354)</strong> show a higher likelihood of supporting transgender rights compared to their male counterparts. On the other hand, <strong>Muslim-Sunni women (0.003874)</strong> also show a higher likelihood of support than men in the same group, although the effect is less pronounced than in Orthodox Christian and Sikh communities.</p>
<p>Finally, the <strong>random effects</strong> for country-level variability (<strong>0.7931</strong>) indicate that there is moderate variation across countries in support for transgender rights. Some countries show significantly higher levels of support, while others exhibit lower support. This underscores the importance of considering country-specific factors when examining attitudes toward transgender rights.</p>
<p>In conclusion, <strong>gender</strong> and <strong>religion</strong> are strong predictors of support for transgender rights, with <strong>atheists and non-religious individuals</strong> showing the highest support. The <strong>interaction between gender and religion</strong> further refines this relationship, showing that women in certain religious groups, such as <strong>Sikh</strong> and <strong>Orthodox Christian</strong> communities, are more likely to support transgender rights. Political ideology plays a smaller role, but still has a positive effect. The model also highlights significant <strong>country-level variations</strong>, suggesting that national context is crucial in shaping individual attitudes toward transgender rights.</p>
<section id="comparison-between-model-1-and-model-2" class="level5">
<h5 class="anchored" data-anchor-id="comparison-between-model-1-and-model-2"><strong>Comparison Between Model 1 and Model 2</strong></h5>
<p>The second model provided a clearer and more nuanced understanding of how gender and religion work together to shape attitudes toward transgender rights. The interaction terms allowed for a deeper analysis of how support for transgender rights differs not just by gender or religion alone, but by their intersection. This approach brought additional complexity and depth to the model, which helped uncover patterns that were not apparent in the first model.</p>
<p>Given that the second model did not significantly improve the AIC, BIC, or other fit statistics compared to the first model, it seems that adding interaction terms does not necessarily enhance the model’s ability to explain support for transgender rights. Therefore, it may be more practical to proceed with the first model, as it offers valuable insights while being simpler and more interpretable.</p>
</section>
</section>
<section id="model-cross-validation" class="level4">
<h4 class="anchored" data-anchor-id="model-cross-validation">Model Cross-Validation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>model_multinomial <span class="ot">&lt;-</span> <span class="fu">multinom</span>(transgender_civil_dc1 <span class="sc">~</span> gender <span class="sc">+</span> religion1 <span class="sc">+</span> ideo1,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  57 (36 variable)
initial  value 26144.775246 
iter  10 value 23446.567187
iter  20 value 22535.689454
iter  30 value 22027.133181
iter  40 value 22001.373213
iter  50 value 22001.286995
iter  50 value 22001.286865
iter  50 value 22001.286865
final  value 22001.286865 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = transgender_civil_dc1 ~ gender + religion1 + 
    ideo1, data = final_data)

Coefficients:
           (Intercept)    gender religion1Orthodox Christian
Don't Know  -1.6710133 0.2978030                -0.001512924
Support     -0.1896638 0.3246451                -0.655995168
           religion1Protestant religion1Other Christian religion1Jewish
Don't Know           0.3725263               -0.1110610     -0.61028939
Support              0.5474152               -0.1281402     -0.02290701
           religion1Muslim - Shia religion1Muslim - Sunni religion1Other Muslim
Don't Know            -0.43586810               0.7098861             0.2905311
Support               -0.01377533              -0.5417258            -0.2842990
           religion1Sikh religion1Buddhist religion1Hindu religion1Atheist
Don't Know    -8.7199862        -1.5106709     -0.2283271       0.06676946
Support       -0.3153707         0.4918285     -0.3390942       0.70629532
           religion1Non believer / Agnostic religion1Other religion1Refusal
Don't Know                       0.04028619     -0.1918305        0.4834563
Support                          0.61004763      0.2249522       -0.2015947
           religion1Don't Know       ideo1
Don't Know           0.3636721  0.26211486
Support             -0.3277169 -0.03985863

Std. Errors:
           (Intercept)     gender religion1Orthodox Christian
Don't Know  0.07918748 0.04486979                  0.05763552
Support     0.05042266 0.02899337                  0.04164813
           religion1Protestant religion1Other Christian religion1Jewish
Don't Know          0.08182966               0.11766778       0.6239551
Support             0.05244812               0.07430728       0.3061085
           religion1Muslim - Shia religion1Muslim - Sunni religion1Other Muslim
Don't Know              0.4899118               0.2285924             0.2568415
Support                 0.2578521               0.2096607             0.2018046
           religion1Sikh religion1Buddhist religion1Hindu religion1Atheist
Don't Know  3.530537e-05         1.0301344      0.7873388       0.10419785
Support     8.195749e-01         0.2946692      0.4874310       0.05980283
           religion1Non believer / Agnostic religion1Other religion1Refusal
Don't Know                       0.08151106     0.12502696        0.1671628
Support                          0.04739462     0.07101064        0.1409140
           religion1Don't Know      ideo1
Don't Know           0.2404378 0.01962275
Support              0.2020117 0.01493047

Residual Deviance: 44002.57 
AIC: 44074.57 </code></pre>
</div>
</div>
<p>The multinomial logistic regression model analyzed the factors influencing support for transgender rights, categorized into Oppose, Don’t Know, and Support. Gender significantly affected support, with women more likely to either support or be uncertain about transgender rights compared to men.</p>
<p>Religion played a major role, with atheists and non-believers showing more support than Orthodox Christians and Muslims. Protestants and Other Christians exhibited moderate support, while Sikh individuals showed significantly lower support.</p>
<p>Ideology showed a positive association with uncertainty about transgender rights but a negative relationship with direct support, suggesting more progressive ideologies lead to more uncertainty rather than support.</p>
<p>The interaction terms revealed that the relationship between gender and religion influences support in specific ways. For example, women in Orthodox Christian and Sikh communities showed differing levels of support compared to men in the same communities.</p>
<p>In conclusion, gender and religion are the main predictors of support for transgender rights, with secular individuals showing stronger support. Ideology also matters but in a more complex way, contributing to uncertainty rather than clear support.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define training control for cross-validation (10-fold cross-validation)</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model using multinomial logistic regression with cross-validation</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">train</span>(transgender_civil_dc1 <span class="sc">~</span> gender <span class="sc">+</span> religion1 <span class="sc">+</span> ideo1,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> final_data,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"multinom"</span>,  <span class="co"># Multinomial logistic regression</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> train_control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20630.653216
iter  20 value 20011.218376
iter  30 value 19812.028411
iter  40 value 19808.043000
final  value 19807.963568 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20631.779017
iter  20 value 20018.359321
iter  30 value 19812.163586
iter  40 value 19809.288390
final  value 19809.288158 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20630.654345
iter  20 value 20011.225516
iter  30 value 19812.028542
iter  40 value 19808.044717
final  value 19807.969910 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20601.310896
iter  20 value 19990.096546
iter  30 value 19802.381849
iter  40 value 19799.344421
final  value 19799.278553 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20602.378557
iter  20 value 19996.966542
iter  30 value 19803.940402
final  value 19800.571976 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20601.311966
iter  20 value 19990.103469
iter  30 value 19802.383267
iter  40 value 19799.346246
final  value 19799.284773 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20611.040098
iter  20 value 19948.766474
iter  30 value 19803.201873
iter  40 value 19798.538246
final  value 19798.472370 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20612.221475
iter  20 value 19952.853824
iter  30 value 19803.430688
iter  40 value 19799.844988
final  value 19799.843960 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20611.041282
iter  20 value 19948.770547
iter  30 value 19803.201897
iter  40 value 19798.540219
final  value 19798.478694 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20613.417597
iter  20 value 20056.090411
iter  30 value 19830.461747
iter  40 value 19819.374273
final  value 19819.290819 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20614.533657
iter  20 value 20060.733147
iter  30 value 19833.007186
iter  40 value 19820.587766
final  value 19820.586528 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20613.418716
iter  20 value 20056.094854
iter  30 value 19830.463785
iter  40 value 19819.375936
final  value 19819.297093 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20599.028743
iter  20 value 19991.142856
iter  30 value 19793.463263
iter  40 value 19788.525475
final  value 19788.474105 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20600.213352
iter  20 value 19997.323566
iter  30 value 19797.628400
iter  40 value 19789.845035
iter  40 value 19789.844883
iter  40 value 19789.844883
final  value 19789.844883 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20599.029931
iter  20 value 19991.149005
iter  30 value 19793.465932
iter  40 value 19788.527560
final  value 19788.480435 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20619.515123
iter  20 value 20073.732374
iter  30 value 19808.714088
iter  40 value 19803.039145
iter  50 value 19802.949491
final  value 19802.948309 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20620.681387
iter  20 value 20077.535610
iter  30 value 19815.331249
iter  40 value 19804.917005
final  value 19804.915257 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20619.516292
iter  20 value 20073.736369
iter  30 value 19808.730834
iter  40 value 19803.043887
final  value 19802.964241 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20638.867961
iter  20 value 20081.816026
iter  30 value 19814.407259
iter  40 value 19806.755477
final  value 19806.676340 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20640.000662
iter  20 value 20090.557735
iter  30 value 19817.227616
iter  40 value 19807.921449
final  value 19807.917408 
converged
# weights:  57 (36 variable)
initial  value 23530.077999 
iter  10 value 20638.869096
iter  20 value 20081.824648
iter  30 value 19814.409682
iter  40 value 19806.756969
final  value 19806.682078 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20581.709840
iter  20 value 19968.066532
iter  30 value 19788.658169
iter  40 value 19784.894616
final  value 19784.839181 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20582.820603
iter  20 value 19972.532464
iter  30 value 19791.597666
iter  40 value 19786.108173
iter  40 value 19786.108043
iter  40 value 19786.108042
final  value 19786.108042 
converged
# weights:  57 (36 variable)
initial  value 23531.176611 
iter  10 value 20581.710954
iter  20 value 19968.071009
iter  30 value 19788.659696
iter  40 value 19784.896506
final  value 19784.845422 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20582.631997
iter  20 value 19937.224945
iter  30 value 19781.562297
iter  40 value 19776.788488
final  value 19776.714303 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20583.777834
iter  20 value 19940.665609
iter  30 value 19780.479592
iter  40 value 19777.965189
final  value 19777.964195 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20582.633145
iter  20 value 19937.228408
iter  30 value 19781.563341
iter  40 value 19776.790206
final  value 19776.720475 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20631.572178
iter  20 value 19944.080227
iter  30 value 19813.616998
iter  40 value 19811.085609
final  value 19811.019197 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20632.729055
iter  20 value 19948.355549
iter  30 value 19819.814617
iter  40 value 19812.187220
final  value 19812.184068 
converged
# weights:  57 (36 variable)
initial  value 23528.979386 
iter  10 value 20631.573337
iter  20 value 19944.084470
iter  30 value 19813.619203
iter  40 value 19811.087202
final  value 19811.024927 
converged
# weights:  57 (36 variable)
initial  value 26144.775246 
iter  10 value 23448.004688
iter  20 value 22545.984523
iter  30 value 22031.738646
iter  40 value 22002.595466
final  value 22002.587685 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check cross-validation results</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Penalized Multinomial Regression 

23798 samples
    3 predictor
    3 classes: 'Oppose', 'Don't Know', 'Support' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 21419, 21418, 21419, 21419, 21418, 21418, ... 
Resampling results across tuning parameters:

  decay  Accuracy   Kappa    
  0e+00  0.5495836  0.1087347
  1e-04  0.5495836  0.1087347
  1e-01  0.5495836  0.1087347

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was decay = 0.1.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for the cross-validation model</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(cv_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cross-Validated (10 fold) Confusion Matrix 

(entries are percentual average cell counts across resamples)
 
            Reference
Prediction   Oppose Don't Know Support
  Oppose        8.9        3.0     6.5
  Don't Know    0.0        0.0     0.0
  Support      26.9        8.6    46.0
                            
 Accuracy (average) : 0.5496</code></pre>
</div>
</div>
</section>
<section id="model-3---adding-country-level" class="level4">
<h4 class="anchored" data-anchor-id="model-3---adding-country-level">Model 3 - Adding Country Level</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>model_eco <span class="ot">&lt;-</span> <span class="fu">lm</span>(transgender_civil_dc <span class="sc">~</span> gdp<span class="sc">+</span> edu_exp_pct <span class="sc">+</span>preprim_exp <span class="sc">+</span> prim_exp <span class="sc">+</span>  lose_exp <span class="sc">+</span>upse_exp<span class="sc">+</span>  ter_exp<span class="sc">+</span> voc_exp,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> final_data)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_eco)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = transgender_civil_dc ~ gdp + edu_exp_pct + preprim_exp + 
    prim_exp + lose_exp + upse_exp + ter_exp + voc_exp, data = final_data)

Coefficients:
(Intercept)          gdp  edu_exp_pct  preprim_exp     prim_exp     lose_exp  
  2.537e+00   -1.377e-13   -7.577e-02   -1.083e-02    9.007e-03    2.491e-02  
   upse_exp      ter_exp      voc_exp  
 -5.815e-02    2.885e-02    9.249e-04  </code></pre>
</div>
</div>
<p>In this analysis, a linear regression model was used to examine the relationship between support for transgender rights (dependent variable) and various economic factors (such as GDP, education expenditures, etc.). In the model, the transgender_civil_dc variable measures support for transgender rights, while the independent variables include various levels of education spending and economic indicators.</p>
<p>The results show that GDP has a negligible effect on support, almost zero, while the impact of education expenditures is more mixed. Primary and tertiary education expenditures were positively related to support, whereas pre-primary and secondary education expenditures showed a slight negative effect. Additionally, vocational education spending had a small positive impact, though minimal.</p>
<p>This model shows that economic factors alone don’t explain much about transgender rights support, as their effects are small and inconsistent. Gender and religion may play a more prominent role, so these factors should be explored further.</p>
</section>
<section id="model-4" class="level4">
<h4 class="anchored" data-anchor-id="model-4">Model 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>final_data_scaled <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gdp, edu_exp_pct, preprim_exp, prim_exp, lose_exp, upse_exp, ter_exp, voc_exp), scale))</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model again</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>model4<span class="ot">&lt;-</span> <span class="fu">glmer</span>(transgender_civil_dc1 <span class="sc">~</span> gender <span class="sc">+</span> religion1 <span class="sc">+</span> ideo1 <span class="sc">+</span> gdp <span class="sc">+</span> edu_exp_pct <span class="sc">+</span> </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>                    preprim_exp <span class="sc">+</span> prim_exp <span class="sc">+</span> lose_exp <span class="sc">+</span> upse_exp <span class="sc">+</span> ter_exp <span class="sc">+</span> voc_exp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> iso3c),</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> final_data_scaled, <span class="at">family =</span> binomial, </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4, <span class="at">correlation =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: 
transgender_civil_dc1 ~ gender + religion1 + ideo1 + gdp + edu_exp_pct +  
    preprim_exp + prim_exp + lose_exp + upse_exp + ter_exp +  
    voc_exp + (1 | iso3c)
   Data: final_data_scaled
Control: glmerControl(optimizer = "bobyqa")

     AIC      BIC   logLik deviance df.resid 
 27849.7  28067.8 -13897.9  27795.7    23771 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.3107 -0.9363  0.4597  0.7151  2.1819 

Random effects:
 Groups Name        Variance Std.Dev.
 iso3c  (Intercept) 0.4373   0.6613  
Number of obs: 23798, groups:  iso3c, 25

Fixed effects:
                                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                       0.024261   0.143344   0.169  0.86560    
gender                            0.401157   0.029590  13.557  &lt; 2e-16 ***
religion1Orthodox Christian      -0.128837   0.070656  -1.823  0.06824 .  
religion1Protestant               0.123543   0.072322   1.708  0.08759 .  
religion1Other Christian         -0.190649   0.082277  -2.317  0.02050 *  
religion1Jewish                  -0.068373   0.326189  -0.210  0.83397    
religion1Muslim - Shia           -0.131398   0.263808  -0.498  0.61843    
religion1Muslim - Sunni          -0.052134   0.196811  -0.265  0.79109    
religion1Other Muslim             0.002083   0.199778   0.010  0.99168    
religion1Sikh                    -0.711129   0.843502  -0.843  0.39919    
religion1Buddhist                 0.088523   0.310748   0.285  0.77574    
religion1Hindu                   -0.437676   0.492568  -0.889  0.37424    
religion1Atheist                  0.550426   0.065816   8.363  &lt; 2e-16 ***
religion1Non believer / Agnostic  0.427637   0.055026   7.772 7.75e-15 ***
religion1Other                    0.104538   0.076805   1.361  0.17349    
religion1Refusal                  0.252110   0.137265   1.837  0.06626 .  
religion1Don't Know              -0.125782   0.193019  -0.652  0.51462    
ideo1                             0.041137   0.015083   2.727  0.00638 ** 
gdp                               0.322509   0.153614   2.099  0.03577 *  
edu_exp_pct                       0.130898   0.155838   0.840  0.40093    
preprim_exp                       0.238757   0.176191   1.355  0.17538    
prim_exp                         -0.078964   0.337410  -0.234  0.81496    
lose_exp                         -1.838046   1.078493  -1.704  0.08833 .  
upse_exp                          2.918437   1.850694   1.577  0.11481    
ter_exp                          -1.256923   0.918762  -1.368  0.17129    
voc_exp                          -0.034899   0.139506  -0.250  0.80246    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
             (Intr) gender rlgn1OrC rlgn1P rlgn1OtC rlgn1J rlgn1Mslm-Sh
gender       -0.320                                                    
rlgn1OrthdC  -0.126 -0.008                                             
rlgn1Prtstn  -0.111  0.009  0.238                                      
rlgn1OthrCh  -0.084  0.013  0.220    0.280                             
relign1Jwsh  -0.016  0.008  0.031    0.040  0.029                      
rlgn1Mslm-Sh -0.025  0.016  0.074    0.040  0.034    0.007             
rlgn1Mslm-Sn -0.038  0.015  0.149    0.077  0.058    0.012  0.027      
rlgn1OthrMs  -0.036  0.011  0.146    0.064  0.053    0.010  0.026      
religin1Skh  -0.005  0.000  0.009    0.016  0.010    0.000  0.002      
rlgn1Bddhst  -0.019  0.012  0.029    0.042  0.031    0.008  0.009      
religin1Hnd  -0.016  0.017  0.026    0.033  0.023    0.003  0.005      
relgn1Athst  -0.107  0.072  0.209    0.258  0.191    0.035  0.046      
rlgn1Nnbl/A  -0.128  0.076  0.238    0.334  0.247    0.045  0.052      
relign1Othr  -0.085  0.024  0.207    0.244  0.190    0.030  0.037      
relign1Rfsl  -0.044  0.019  0.142    0.090  0.075    0.016  0.022      
rlgn1Dn'tKn  -0.035  0.008  0.120    0.086  0.079    0.009  0.017      
ideo1         0.013 -0.043 -0.001    0.017 -0.006    0.002  0.002      
gdp           0.043  0.002  0.027    0.003  0.005   -0.001  0.001      
edu_exp_pct   0.006  0.003  0.026   -0.053 -0.019   -0.001 -0.001      
preprim_exp   0.048  0.001 -0.018   -0.009 -0.006    0.003 -0.001      
prim_exp     -0.055  0.001  0.015    0.015  0.010   -0.001  0.004      
lose_exp      0.026  0.000  0.020    0.017  0.001    0.011  0.004      
upse_exp     -0.018  0.000 -0.020   -0.012  0.002   -0.012 -0.005      
ter_exp       0.023  0.000  0.009    0.007 -0.006    0.012  0.004      
voc_exp       0.032  0.000 -0.005   -0.002 -0.012    0.000  0.000      
             rlgn1Mslm-Sn rlg1OM rlgn1S rlgn1B rlgn1H rlgn1A r1Nb/A rlgn1O
gender                                                                    
rlgn1OrthdC                                                               
rlgn1Prtstn                                                               
rlgn1OthrCh                                                               
relign1Jwsh                                                               
rlgn1Mslm-Sh                                                              
rlgn1Mslm-Sn                                                              
rlgn1OthrMs   0.049                                                       
religin1Skh   0.004        0.003                                          
rlgn1Bddhst   0.012        0.011  0.003                                   
religin1Hnd   0.008        0.007  0.002  0.005                            
relgn1Athst   0.069        0.065  0.012  0.038  0.025                     
rlgn1Nnbl/A   0.078        0.071  0.015  0.049  0.032  0.281              
relign1Othr   0.060        0.056  0.011  0.033  0.022  0.197  0.248       
relign1Rfsl   0.040        0.042  0.006  0.017  0.011  0.082  0.100  0.077
rlgn1Dn'tKn   0.033        0.033  0.004  0.010  0.008  0.072  0.088  0.070
ideo1        -0.008       -0.034  0.006  0.014 -0.001  0.018  0.005  0.005
gdp           0.001        0.002  0.000 -0.003 -0.001 -0.003  0.002  0.004
edu_exp_pct  -0.001        0.000 -0.004 -0.002 -0.003 -0.017 -0.030 -0.016
preprim_exp  -0.004       -0.001  0.002  0.002  0.002 -0.002  0.003 -0.001
prim_exp      0.006        0.003 -0.002  0.001 -0.001  0.009  0.008  0.009
lose_exp      0.002        0.001 -0.005  0.002  0.001  0.005  0.002  0.004
upse_exp     -0.002       -0.001  0.005 -0.002  0.000 -0.004 -0.001 -0.002
ter_exp       0.000       -0.001 -0.005  0.001  0.001  0.002  0.000 -0.001
voc_exp      -0.003       -0.002 -0.001 -0.001  0.000 -0.004 -0.012 -0.008
             rlgn1R rl1D'K ideo1  gdp    ed_xp_ prprm_ prm_xp los_xp ups_xp
gender                                                                     
rlgn1OrthdC                                                                
rlgn1Prtstn                                                                
rlgn1OthrCh                                                                
relign1Jwsh                                                                
rlgn1Mslm-Sh                                                               
rlgn1Mslm-Sn                                                               
rlgn1OthrMs                                                                
religin1Skh                                                                
rlgn1Bddhst                                                                
religin1Hnd                                                                
relgn1Athst                                                                
rlgn1Nnbl/A                                                                
relign1Othr                                                                
relign1Rfsl                                                                
rlgn1Dn'tKn   0.037                                                        
ideo1        -0.087 -0.058                                                 
gdp           0.002  0.003  0.003                                          
edu_exp_pct   0.001 -0.004  0.010 -0.241                                   
preprim_exp   0.002 -0.004 -0.002  0.342 -0.168                            
prim_exp      0.004  0.003 -0.008 -0.217  0.198 -0.617                     
lose_exp      0.012 -0.003  0.005 -0.045  0.244  0.097 -0.089              
upse_exp     -0.012  0.004 -0.003  0.021 -0.219  0.000 -0.134 -0.946       
ter_exp       0.010 -0.006  0.004  0.034  0.138  0.037  0.100  0.862 -0.962
voc_exp      -0.003 -0.006  0.008 -0.164  0.260  0.031  0.007  0.125 -0.140
             ter_xp
gender             
rlgn1OrthdC        
rlgn1Prtstn        
rlgn1OthrCh        
relign1Jwsh        
rlgn1Mslm-Sh       
rlgn1Mslm-Sn       
rlgn1OthrMs        
religin1Skh        
rlgn1Bddhst        
religin1Hnd        
relgn1Athst        
rlgn1Nnbl/A        
relign1Othr        
relign1Rfsl        
rlgn1Dn'tKn        
ideo1              
gdp                
edu_exp_pct        
preprim_exp        
prim_exp           
lose_exp           
upse_exp           
ter_exp            
voc_exp       0.169</code></pre>
</div>
</div>
</section>
<section id="correlation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correcting the select() function by adding quotes around each variable name</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>cor_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"gender"</span>, <span class="st">"religion"</span>, <span class="st">"ideo"</span>, <span class="st">"gdp"</span>, <span class="st">"edu_exp_pct"</span>, <span class="st">"preprim_exp"</span>, <span class="st">"prim_exp"</span>, <span class="st">"lose_exp"</span>, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"upse_exp"</span>, <span class="st">"ter_exp"</span>, <span class="st">"voc_exp"</span>, <span class="st">"psychological.care"</span>, <span class="st">"psychiatric.care"</span>, <span class="st">"nolger"</span>, </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"exist_lgme"</span>, <span class="st">"exist_adm"</span>, <span class="st">"name_change"</span>, <span class="st">"self_det"</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View the correlation matrix</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         gender    religion         ideo         gdp
gender              1.000000000 -0.08560361  0.064203017 -0.02839256
religion           -0.085603609  1.00000000 -0.048155719  0.09496691
ideo                0.064203017 -0.04815572  1.000000000 -0.03770291
gdp                -0.028392556  0.09496691 -0.037702914  1.00000000
edu_exp_pct        -0.034652039  0.22566148 -0.114132169  0.07562013
preprim_exp         0.007895160 -0.16244843  0.075557961 -0.23577746
prim_exp           -0.034479544 -0.21757662  0.041227956  0.19033506
lose_exp           -0.042722670 -0.18853825 -0.007620356  0.21208547
upse_exp           -0.044182312 -0.17998023 -0.016309584  0.16381250
ter_exp            -0.039994823 -0.15295263 -0.026601617  0.08407105
voc_exp             0.001548353  0.05727729 -0.015529248  0.14838321
psychological.care  0.007421641 -0.02616284 -0.029334724 -0.10723227
psychiatric.care    0.007421641 -0.02616284 -0.029334724 -0.10723227
nolger             -0.001499071  0.04793652  0.010741233  0.17766559
exist_lgme         -0.024439014  0.11885161 -0.071147909  0.29531597
exist_adm          -0.019884082  0.07687816 -0.056764790  0.25399888
name_change        -0.017791734  0.17248795 -0.014206207  0.29759538
self_det           -0.034097837 -0.03763173 -0.057802259 -0.03376896
                   edu_exp_pct preprim_exp    prim_exp     lose_exp    upse_exp
gender             -0.03465204  0.00789516 -0.03447954 -0.042722670 -0.04418231
religion            0.22566148 -0.16244843 -0.21757662 -0.188538250 -0.17998023
ideo               -0.11413217  0.07555796  0.04122796 -0.007620356 -0.01630958
gdp                 0.07562013 -0.23577746  0.19033506  0.212085469  0.16381250
edu_exp_pct         1.00000000 -0.02933800 -0.19568843 -0.165767548 -0.07320431
preprim_exp        -0.02933800  1.00000000  0.41357867  0.172928278  0.16073773
prim_exp           -0.19568843  0.41357867  1.00000000  0.885400954  0.85161676
lose_exp           -0.16576755  0.17292828  0.88540095  1.000000000  0.95719528
upse_exp           -0.07320431  0.16073773  0.85161676  0.957195280  1.00000000
ter_exp             0.01525089  0.11470668  0.71847850  0.810824001  0.94262829
voc_exp            -0.24569039 -0.06827422  0.01661410  0.032763357 -0.01795285
psychological.care -0.11786981 -0.14245914  0.05650754  0.075295243 -0.03088840
psychiatric.care   -0.11786981 -0.14245914  0.05650754  0.075295243 -0.03088840
nolger              0.17440459  0.03548106 -0.10088256 -0.128497553 -0.07081200
exist_lgme          0.13825850  0.15884325 -0.10682445 -0.279395830 -0.25438912
exist_adm           0.30349285 -0.02328963  0.09098288  0.160086319  0.23554873
name_change         0.40770803 -0.08987504 -0.17583724 -0.126976623 -0.11675203
self_det            0.21720947  0.27814731  0.02398094 -0.017600517  0.05753120
                        ter_exp      voc_exp psychological.care
gender             -0.039994823  0.001548353        0.007421641
religion           -0.152952626  0.057277288       -0.026162835
ideo               -0.026601617 -0.015529248       -0.029334724
gdp                 0.084071047  0.148383209       -0.107232266
edu_exp_pct         0.015250887 -0.245690393       -0.117869811
preprim_exp         0.114706683 -0.068274216       -0.142459142
prim_exp            0.718478497  0.016614095        0.056507541
lose_exp            0.810824001  0.032763357        0.075295243
upse_exp            0.942628287 -0.017952847       -0.030888399
ter_exp             1.000000000 -0.090416625       -0.145077891
voc_exp            -0.090416625  1.000000000        0.104882351
psychological.care -0.145077891  0.104882351        1.000000000
psychiatric.care   -0.145077891  0.104882351        1.000000000
nolger              0.006011042 -0.187746920       -0.690058291
exist_lgme         -0.186884146  0.088469590       -0.382835310
exist_adm           0.298063127 -0.237772039       -0.465013654
name_change        -0.119966475 -0.031948866       -0.406636782
self_det            0.110298375 -0.104338065       -0.137981110
                   psychiatric.care       nolger  exist_lgme   exist_adm
gender                  0.007421641 -0.001499071 -0.02443901 -0.01988408
religion               -0.026162835  0.047936524  0.11885161  0.07687816
ideo                   -0.029334724  0.010741233 -0.07114791 -0.05676479
gdp                    -0.107232266  0.177665588  0.29531597  0.25399888
edu_exp_pct            -0.117869811  0.174404587  0.13825850  0.30349285
preprim_exp            -0.142459142  0.035481063  0.15884325 -0.02328963
prim_exp                0.056507541 -0.100882563 -0.10682445  0.09098288
lose_exp                0.075295243 -0.128497553 -0.27939583  0.16008632
upse_exp               -0.030888399 -0.070812001 -0.25438912  0.23554873
ter_exp                -0.145077891  0.006011042 -0.18688415  0.29806313
voc_exp                 0.104882351 -0.187746920  0.08846959 -0.23777204
psychological.care      1.000000000 -0.690058291 -0.38283531 -0.46501365
psychiatric.care        1.000000000 -0.690058291 -0.38283531 -0.46501365
nolger                 -0.690058291  1.000000000  0.55478691  0.67387590
exist_lgme             -0.382835310  0.554786914  1.00000000  0.28640856
exist_adm              -0.465013654  0.673875903  0.28640856  1.00000000
name_change            -0.406636782  0.589278888  0.44947765  0.60156989
self_det               -0.137981110  0.199955730  0.36041897  0.29672486
                   name_change    self_det
gender             -0.01779173 -0.03409784
religion            0.17248795 -0.03763173
ideo               -0.01420621 -0.05780226
gdp                 0.29759538 -0.03376896
edu_exp_pct         0.40770803  0.21720947
preprim_exp        -0.08987504  0.27814731
prim_exp           -0.17583724  0.02398094
lose_exp           -0.12697662 -0.01760052
upse_exp           -0.11675203  0.05753120
ter_exp            -0.11996648  0.11029838
voc_exp            -0.03194887 -0.10433807
psychological.care -0.40663678 -0.13798111
psychiatric.care   -0.40663678 -0.13798111
nolger              0.58927889  0.19995573
exist_lgme          0.44947765  0.36041897
exist_adm           0.60156989  0.29672486
name_change         1.00000000  0.33932275
self_det            0.33932275  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survey_Methodology_Prj_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The correlation analysis shows some strong relationships between certain variables. For instance, there is a high correlation between lose_exp, upse_exp, and ter_exp, indicating that these variables measure similar aspects. To avoid multicollinearity, it would be advisable to remove one of these variables from the model.</p>
<p>Similarly, psychological.care and psychiatric.care are perfectly correlated with each other, suggesting that only one of them should remain in the model. Removing the redundant variable will simplify the model without losing meaningful information.</p>
<p>There are also moderate positive correlations between GDP and variables like lose_exp and voc_exp, meaning wealthier countries tend to spend more on education and vocational training. On the other hand, gender and religion show weak correlations with economic and educational variables, implying that these factors have less impact on these areas.</p>
</section>
</section>
<section id="final-data" class="level3">
<h3 class="anchored" data-anchor-id="final-data">Final data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>sec_exp <span class="ot">&lt;-</span> final_data<span class="sc">$</span>lose_exp <span class="sc">+</span> final_data<span class="sc">$</span>upse_exp</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>prim_exp <span class="ot">&lt;-</span> final_data<span class="sc">$</span>preprim_exp <span class="sc">+</span> final_data<span class="sc">$</span>prim_exp</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>psychiatric.care)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country iso3c serialid lifesat natmat eumat locmat euvoice natvoice polintr
1 Belgium   BEL        1       2      3     3      1       2        2       3
2 Belgium   BEL        2       2      2     3      3       1        1       3
3 Belgium   BEL        3       1      2     3      3       2        2       3
4 Belgium   BEL        4       1      1     1      1       2        2       1
5 Belgium   BEL        5       2      1     1      1       1        1       1
6 Belgium   BEL        6       1      2     2      2       2        2       2
  gender community ideo class ethnic skin relig roma sex disab other religion
1      1         3    7     2      0    0     0    0   0     0     0        1
2      2         3    8     3      0    0     0    0   0     0     0        1
3      2         3    4     2      0    0     0    0   0     0     0       12
4      1         3   10     4      0    0     0    0   0     0     0       12
5      2         3    8     4      0    0     0    0   0     0     0        1
6      2         3    7     3      0    0     0    0   0     0     0       13
  sexdiscr transdiscr interdiscr age_edu_5cat age_edu_11cat age_edu
1        2          4          4            7             3      20
2        3          2          2            6             2      19
3        2          2          1            6             2      19
4        2          2          2            9             3      25
5        2          2          4            9             3      23
6        2          1          2            8             3      21
  transgender_civil_dc school_div_transgender school_div_sexual_orientation
1                    1                      2                             1
2                    1                      3                             1
3                    1                      3                             2
4                    1                      2                             2
5                    1                      1                             1
6                    1                      3                             1
  school_div_intersex year          gdp edu_exp_pct preprim_exp prim_exp
1                   2 2019 536726344405     6.33397    93.02088 187.5953
2                   3 2019 536726344405     6.33397    93.02088 187.5953
3                   3 2019 536726344405     6.33397    93.02088 187.5953
4                   2 2019 536726344405     6.33397    93.02088 187.5953
5                   1 2019 536726344405     6.33397    93.02088 187.5953
6                   4 2019 536726344405     6.33397    93.02088 187.5953
  lose_exp upse_exp  ter_exp  voc_exp psychological.care breast.augmentation
1 97.17226 96.71211 96.47124 74.38538                  1                   1
2 97.17226 96.71211 96.47124 74.38538                  1                   1
3 97.17226 96.71211 96.47124 74.38538                  1                   1
4 97.17226 96.71211 96.47124 74.38538                  1                   1
5 97.17226 96.71211 96.47124 74.38538                  1                   1
6 97.17226 96.71211 96.47124 74.38538                  1                   1
  electrolysis...laser.hair.removal facial.feminisation.surgery hrt..oestrogen.
1                                 1                           1               1
2                                 1                           1               1
3                                 1                           1               1
4                                 1                           1               1
5                                 1                           1               1
6                                 1                           1               1
  hrt..testosterone. hysterectomy mastectomy metoidioplasty orchiectomy
1                  1            1          1              1           1
2                  1            1          1              1           1
3                  1            1          1              1           1
4                  1            1          1              1           1
5                  1            1          1              1           1
6                  1            1          1              1           1
  ovariectomy..aka.oopherectomy. phalloplasty tracheal.shave vaginoplasty
1                              1            1              1            1
2                              1            1              1            1
3                              1            1              1            1
4                              1            1              1            1
5                              1            1              1            1
6                              1            1              1            1
  vocal.training nolger exist_lgme exist_adm name_change nar_name_change
1              1      1          1         1           1               0
2              1      1          1         1           1               0
3              1      1          1         1           1               0
4              1      1          1         1           1               0
5              1      1          1         1           1               0
6              1      1          1         1           1               0
  self_det nb_recog psych_diag med_interven surg_interven steril_req div_req
1        1        0          1            1             1          1       1
2        1        0          1            1             1          1       1
3        1        0          1            1             1          1       1
4        1        0          1            1             1          1       1
5        1        0          1            1             1          1       1
6        1        0          1            1             1          1       1
  age_restrict lgrp_minors depath               religion1 iso3c1         region
1            0           1      0                Catholic     NA Western Europe
2            0           1      0                Catholic     NA Western Europe
3            0           1      0                 Atheist     NA Western Europe
4            0           1      0                 Atheist     NA Western Europe
5            0           1      0                Catholic     NA Western Europe
6            0           1      0 Non believer / Agnostic     NA Western Europe
  transgender_civil_dc1      ideo1 gender_squared  sec_exp
1               Support -0.4185857              1 193.8844
2               Support -0.3903086              4 193.8844
3               Support -0.5034172              4 193.8844
4               Support -0.3337543              1 193.8844
5               Support -0.3903086              4 193.8844
6               Support -0.4185857              4 193.8844</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="statistical-model" class="level2">
<h2 class="anchored" data-anchor-id="statistical-model">Statistical Model</h2>
<p>INDIVIDUAL LEVEL</p>
<p><strong>Gender</strong> ## EVERYTHING FROM UNTIL OTHERWISE INDICATED CAN BE EDITED TO FIT OUR VARIABLE ##</p>
<p><strong>Age</strong></p>
<p><strong>Political_ideology</strong></p>
<p><em>In political matters people talk of “the left” and “the right”. How would you place your views on this scale?</em></p>
<p><strong>Religion_cat</strong></p>
<p><em>Do you consider yourself to be…?</em></p>
<p><strong>Contact with transgender people (sd1_7)</strong></p>
<p><em>Do you have friends or acquaintances who are transgender?</em></p>
<p><strong>Age when completing full-time education (d8)</strong></p>
<p><em>How old were you when you stopped full‐time education?</em></p>
<p><strong>Personal economic situation (d60_ordinal)</strong></p>
<p><em>During the last twelve months, would you say you had difficulties to pay your bills at the end of the month…?</em></p>
<p><strong>Sexual minority(sd2_5)</strong></p>
<p><em>Where you live, do you consider yourself to be part of a sexual minority?</em></p>
<p><strong>Place of residence (type) (d25)</strong></p>
<p><em>Would you say you live in a…?</em></p>
<p><strong>Equal rights for the LGB community (qc15_1_ordinal)</strong></p>
<p><strong>Discrimination against the transgender community (qc1_8_ordinal)</strong></p>
<p>COUNTRY LEVEL</p>
<p><strong>Variables created earlier country level.</strong></p>
<p><strong>adp_general</strong></p>
<p><strong>Country_name</strong> ## END OF VARIABLE EDITS ##</p>
<p>DATA FINAL COUNTRY</p>
<p>DATA FINAL INDIVIDUAL</p>
<section id="regression-analysis-individual-level" class="level3">
<h3 class="anchored" data-anchor-id="regression-analysis-individual-level">Regression Analysis Individual Level</h3>
</section>
<section id="multi-level-analysis" class="level3">
<h3 class="anchored" data-anchor-id="multi-level-analysis">Multi-level analysis</h3>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
</section>
</section>
<section id="prediction" class="level2">
<h2 class="anchored" data-anchor-id="prediction">PREDICTION</h2>
<p>Our goal is to develop a model capable of predicting support for transgender individuals changing civil documents. To accurately forecast our target variable, we must first establish a clear definition of the outcome we aim to predict.</p>
<section id="models-to-follow" class="level3">
<h3 class="anchored" data-anchor-id="models-to-follow">Models to Follow</h3>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>